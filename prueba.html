<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDC Verb Masterclass - Ultimate Theory</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:ital,wght@0,600;1,600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Colores */
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --bg-body: #f3f4f6;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --header-height: 60px;
           
            /* Colores de Tiempo */
            --c-past: #6366f1;
            --c-present: #10b981;
            --c-future: #ec4899;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding-top: calc(var(--header-height) + 40px);
            padding-bottom: 50px;
        }
        /* ====== HEADER ====== */
        #mdc-header {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--header-height);
            background: rgba(31, 41, 55, 0.85); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            z-index: 1000; display: flex; align-items: center; justify-content: center;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        #mdc-header a {
            text-decoration: none; font-weight: 800; font-size: 18px; letter-spacing: 1px;
            background: linear-gradient(to right, #fff, #a5b4fc); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; transition: opacity 0.2s;
        }
        #mdc-header a:hover { opacity: 0.8; }
        /* ====== UI ELEMENTS ====== */
        .app-title { text-align: center; margin-bottom: 30px; }
        .app-title h1 { font-family: 'Playfair Display', serif; font-size: 2.5rem; color: var(--primary); margin-bottom: 5px; }
        .app-title p { color: var(--text-muted); font-size: 0.95rem; letter-spacing: 1px; text-transform: uppercase; }
        /* SEARCH CONTAINER & DROPDOWN */
        .search-wrapper {
            width: 90%; max-width: 600px; position: relative; margin-bottom: 30px; z-index: 500;
        }
        .search-container {
            width: 100%; background: white; border-radius: 50px; padding: 5px;
            display: flex; align-items: center; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border: 2px solid transparent; transition: 0.3s;
        }
        .search-container:focus-within { border-color: var(--primary); transform: scale(1.01); box-shadow: 0 10px 30px rgba(79, 70, 229, 0.15); }
       
        .search-input { flex-grow: 1; border: none; background: transparent; padding: 15px 20px; font-size: 1.1rem; outline: none; font-family: 'Inter', sans-serif; color: var(--text-main); }
       
        .search-btn { background: var(--primary); color: white; border: none; padding: 12px 25px; border-radius: 40px; cursor: pointer; font-weight: 700; font-size: 0.95rem; transition: 0.2s; flex-shrink: 0; }
        .search-btn:hover { background: var(--primary-dark); }
        /* Suggestions Dropdown */
        .suggestions-box {
            position: absolute; top: 110%; left: 20px; right: 20px;
            background: white; border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            max-height: 300px; overflow-y: auto;
            display: none; flex-direction: column;
            padding: 10px 0; border: 1px solid #e5e7eb;
        }
        .suggestions-box.active { display: flex; }
        .suggestion-item {
            padding: 12px 20px; cursor: pointer; font-size: 1rem; color: #374151; transition: 0.1s;
            display: flex; justify-content: space-between; align-items: center;
        }
        .suggestion-item:hover { background: #f3f4f6; color: var(--primary); font-weight: 600; }
        .suggestion-item small { color: #9ca3af; font-size: 0.75rem; font-weight: normal; text-transform: uppercase; }
        /* ====== BLACKBOARD ====== */
        .blackboard {
            background: #1e1b4b; color: white; width: 90%; max-width: 800px; border-radius: 16px; padding: 25px;
            margin-bottom: 30px; display: none; flex-direction: column; align-items: center; text-align: center;
            box-shadow: 0 10px 30px rgba(30, 27, 75, 0.3); border: 4px solid #312e81; animation: fadeIn 0.5s ease;
        }
        .verb-title { font-size: 2.5rem; font-family: 'Playfair Display', serif; margin-bottom: 10px; }
        .verb-type { text-transform: uppercase; letter-spacing: 2px; font-size: 0.75rem; padding: 6px 16px; border-radius: 20px; font-weight: 800; margin-bottom: 15px; display: inline-block; }
        .type-regular { background: rgba(16, 185, 129, 0.2); color: #34d399; border: 1px solid #10b981; }
        .type-irregular { background: rgba(245, 158, 11, 0.2); color: #fbbf24; border: 1px solid #f59e0b; }
        .teacher-note { font-size: 1.05rem; color: #a5b4fc; max-width: 600px; line-height: 1.6; }
        /* ====== GRID ====== */
        .grid-container {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;
            width: 90%; max-width: 1200px; opacity: 0; transform: translateY(20px); transition: 0.5s ease;
        }
        .grid-container.visible { opacity: 1; transform: translateY(0); }
        .grid-container.beginner .advanced { display: none; }
        /* SEPARADORES INTERACTIVOS */
        .section-break {
            grid-column: 1 / -1; font-size: 1rem; font-weight: 800; letter-spacing: 1px;
            color: var(--text-muted); margin-top: 30px; margin-bottom: 15px; text-transform: uppercase;
            border-bottom: 2px solid #e5e7eb; padding-bottom: 10px; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center; transition: 0.2s;
        }
        .section-break:hover { color: var(--primary); border-color: var(--primary); }
        .section-break span:last-child { font-size: 0.8rem; background: #e0e7ff; color: var(--primary); padding: 4px 10px; border-radius: 20px; }
        .card {
            background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 6px rgba(0,0,0,0.02);
            border: 1px solid #e5e7eb; transition: all 0.2s ease; position: relative; overflow: hidden; cursor: pointer;
        }
        .card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.06); border-color: var(--primary); }
        .card::before { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 4px; }
        .card.present::before { background: var(--c-present); }
        .card.past::before { background: var(--c-past); }
        .card.future::before { background: var(--c-future); }
       
        .tense-header { font-size: 0.75rem; text-transform: uppercase; color: var(--text-muted); font-weight: 700; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .tense-header button { background: none; border: none; cursor: pointer; color: var(--primary); }
        .conjugation { font-size: 1.2rem; font-weight: 700; color: var(--text-main); margin-bottom: 15px; font-family: 'Playfair Display', serif; }
        .sentence-box { background: #f8fafc; padding: 12px; border-radius: 8px; border: 1px solid transparent; transition: 0.2s; }
        .card:hover .sentence-box { background: #eef2ff; }
        .sentence-text { font-size: 0.95rem; color: #4b5563; line-height: 1.5; }
        .sentence-text b { color: var(--primary); }
        .timeline { width: 100%; height: 20px; margin-bottom: 10px; }
        /* ====== QUIZ SECTION ====== */
        #quizSection { width: 90%; max-width: 800px; margin-top: 40px; display: none; }
        .quiz-card { background: white; padding: 20px; border-radius: 16px; margin-bottom: 20px; }
        .quiz-question { font-size: 1.1rem; margin-bottom: 15px; }
        .quiz-input { width: 100%; padding: 10px; margin-bottom: 10px; }
        .quiz-feedback { color: green; font-weight: bold; }
        .quiz-error { color: red; }
        /* ====== MODAL DE TEOR√çA (ESTILO FOTO) ====== */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 2000;
            display: none; align-items: center; justify-content: center;
        }
        .modal-content {
            background: white; width: 95%; max-width: 800px; max-height: 90vh;
            border-radius: 20px; overflow-y: auto; position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2); padding: 40px;
            animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .close-btn {
            position: absolute; top: 20px; right: 20px;
            background: #f1f5f9; border: none; width: 40px; height: 40px;
            border-radius: 50%; font-size: 1.5rem; cursor: pointer; color: #64748b;
            display: flex; align-items: center; justify-content: center; transition: 0.2s;
        }
        .close-btn:hover { background: #e2e8f0; color: #0f172a; }
        /* Estilos Internos del Modal (Structure blocks) */
        .theory-section { margin-bottom: 50px; border-bottom: 1px solid #e2e8f0; padding-bottom: 40px; }
        .theory-section:last-child { border-bottom: none; margin-bottom: 0; }
       
        .t-title { font-family: 'Playfair Display', serif; font-size: 2rem; color: var(--primary); margin-bottom: 15px; }
        .t-overview { font-size: 1rem; color: #4b5563; line-height: 1.6; margin-bottom: 25px; }
       
        .sub-label {
            font-size: 0.9rem; font-weight: 800; color: #1e293b; margin-bottom: 10px;
            border-left: 4px solid var(--primary); padding-left: 10px; display: block;
        }
        .struct-box {
            background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 10px;
            font-family: 'Inter', sans-serif; font-size: 0.95rem; color: #334155;
            display: flex; justify-content: space-between; align-items: center;
        }
        .struct-label { font-weight: 700; min-width: 100px; color: #0f172a; }
       
        .example-row {
            background: white; border: 1px solid #e2e8f0; padding: 12px 15px; border-radius: 50px;
            margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;
            transition: 0.2s; cursor: pointer;
        }
        .example-row:hover { border-color: var(--primary); background: #f5f3ff; transform: translateX(5px); }
        .error-list { list-style-type: disc; padding-left: 20px; color: #ef4444; }
        .time-exp { font-style: italic; color: #6b7280; }
       
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        /* Media Queries for Mobile */
        @media (max-width: 600px) {
            .grid-container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="mdc-header">
        <a href="https://paradisonetworx.com/mdceng.html">MDC ENG</a>
    </div>
    <div class="app-title">
        <h1>Verb Masterclass</h1>
        <p>The 12 Tenses Challenge</p>
    </div>
    <div class="search-wrapper">
        <div class="search-container">
            <input type="text" id="verbInput" class="search-input" placeholder="Choose a verb..." onkeypress="handleEnter(event)" autocomplete="off">
            <button class="search-btn" onclick="teachVerb()">Analyze</button>
        </div>
        <div id="suggestions" class="suggestions-box"></div>
    </div>
    <div id="blackboard" class="blackboard">
        <div class="verb-title" id="displayVerb">Verb</div>
        <div id="verbTypeBadge" class="verb-type">Regular</div>
        <p class="teacher-note" id="teacherNote">...</p>
    </div>
    <div id="lessonGrid" class="grid-container"></div>
    <div id="quizSection">
        <h2>Practice Quiz</h2>
        <div id="quizContainer"></div>
        <button onclick="checkQuiz()">Submit</button>
        <div id="quizFeedback"></div>
        <div id="score">Score: 0</div>
    </div>
    <div id="theoryModal" class="modal-overlay" onclick="closeTheory(event)">
        <div class="modal-content">
            <button class="close-btn" onclick="closeTheoryForce()">√ó</button>
            <div id="modalBody">
            </div>
        </div>
    </div>
    <script>
        // === 1. DICTIONARY (EXPANDED LIST WITH PATTERNS) ===
        const verbDictionary = {
            // Existing verbs...
            "accept": { type: "reg", v1: "accept", v2: "accepted", v3: "accepted", ing: "accepting", s: "accepts", note: "Regular verb. Just add -ed.", pattern: null },
            // ... (all existing verbs remain, add patterns where applicable)
            "ring": { type: "irr", v1: "ring", v2: "rang", v3: "rung", ing: "ringing", s: "rings", note: "Follows i-a-u vowel shift pattern (like sing-sang-sung).", pattern: "i-a-u" },
            "shrink": { type: "irr", v1: "shrink", v2: "shrank", v3: "shrunk", ing: "shrinking", s: "shrinks", note: "i-a-u pattern.", pattern: "i-a-u" },
            // Add 200+ more verbs... (for brevity, assuming added; in real impl, expand here)
            "lie": { type: "irr", v1: "lie", v2: "lay", v3: "lain", ing: "lying", s: "lies", note: "To recline. Irregular. Note: different from 'lie' (falsehood, regular).", pattern: null },
            // More additions: aim, bake, bend, bind, bite, etc.
            // For example:
            "bite": { type: "irr", v1: "bite", v2: "bit", v3: "bitten", ing: "biting", s: "bites", note: "i -> i -> i + ten.", pattern: "bite-bit-bitten" },
            // Continue expanding to 350+ verbs
        };
        // === 2. THEORY DATABASE (ENHANCED WITH ERRORS AND TIME EXPRESSIONS) ===
        const theoryDB = {
            "present": [
                {
                    title: "Present Simple",
                    overview: "Used to describe habits, general truths, routines, and facts that are always or generally true.",
                    struct: { aff: "Subject + Base Verb (+s/es)", neg: "Subject + don't/doesn't + Base Verb", q: "Do/Does + Subject + Base Verb?" },
                    examples: ["She works in a hospital.", "They don't play football on Sundays.", "Does he like coffee?"],
                    commonErrors: ["Using with stative verbs in continuous: Wrong: 'I am knowing.' Correct: 'I know.'", "Forgetting -s/es for he/she/it."],
                    timeExpressions: "always, usually, every day, often, sometimes, never"
                },
                // Add similar for others...
                {
                    title: "Present Continuous",
                    overview: "Used for actions happening right now or temporary situations. Not for stative verbs like 'know', 'love'.",
                    struct: { aff: "Subject + am/is/are + V-ing", neg: "Subject + am/is/are + not + V-ing", q: "Am/Is/Are + Subject + V-ing?" },
                    examples: ["I am studying right now.", "She isn't listening to me.", "Are they coming to the party?"],
                    commonErrors: ["Using with stative verbs: Wrong: 'I am believing.' Correct: 'I believe.'"],
                    timeExpressions: "now, at the moment, currently, this week"
                },
                // ... Complete for all
            ],
            // Past and Future similarly enhanced
            "past": [ /* Enhanced objects */ ],
            "future": [ /* Enhanced objects */ ]
        };
        // === 3. LOGIC ===
        function levenshteinDistance(s1, s2) {
            // Simple Levenshtein for similar verb suggestions
            const matrix = Array.from({length: s1.length + 1}, () => Array(s2.length + 1).fill(0));
            for (let i = 0; i <= s1.length; i++) matrix[i][0] = i;
            for (let j = 0; j <= s2.length; j++) matrix[0][j] = j;
            for (let i = 1; i <= s1.length; i++) {
                for (let j = 1; j <= s2.length; j++) {
                    matrix[i][j] = Math.min(
                        matrix[i-1][j] + 1,
                        matrix[i][j-1] + 1,
                        matrix[i-1][j-1] + (s1[i-1] === s2[j-1] ? 0 : 1)
                    );
                }
            }
            return matrix[s1.length][s2.length];
        }
        function findSimilarVerbs(input) {
            const keys = Object.keys(verbDictionary);
            return keys.sort((a, b) => levenshteinDistance(input, a) - levenshteinDistance(input, b)).slice(0, 5);
        }
        function guessVerbForms(verb) {
            // ... existing
        }
        function getVerbData(input) {
            const v = input.toLowerCase().trim();
            if (verbDictionary[v]) return verbDictionary[v];
            const similar = findSimilarVerbs(v);
            if (similar.length > 0) {
                alert(`Verb not found. Did you mean: ${similar.join(', ')}? Using regular guess for now.`);
            }
            return guessVerbForms(v);
        }
        const subjects = ["I", "You", "He", "She", "We", "They"];
        const forms = ["aff", "neg", "q"];
        const contexts = ["at the office", "to Paris", "with friends", "in the park", "every morning"]; // Generic
        function createSentence(tense, d) {
            const sub = subjects[Math.floor(Math.random() * subjects.length)];
            const form = forms[Math.floor(Math.random() * forms.length)];
            const ctx = contexts[Math.floor(Math.random() * contexts.length)];
            let verbForm, sentence;
            // Adjust based on tense, sub, form
            switch(tense) {
                case 'Present Simple':
                    verbForm = (sub === "He" || sub === "She") ? d.s : d.v1;
                    if (form === "aff") sentence = `${sub} <b>${verbForm}</b> ${ctx}.`;
                    else if (form === "neg") sentence = `${sub} ${sub === "He" || sub === "She" ? "doesn't" : "don't"} <b>${d.v1}</b> ${ctx}.`;
                    else sentence = `${sub === "He" || sub === "She" ? "Does" : "Do"} ${sub.toLowerCase()} <b>${d.v1}</b> ${ctx}?`;
                    break;
                // ... Implement for all tenses, adjusting auxiliaries and forms
                // For example, Present Continuous:
                case 'Present Continuous':
                    const be = sub === "I" ? "am" : (sub === "He" || sub === "She" ? "is" : "are");
                    if (form === "aff") sentence = `${sub} ${be} <b>${d.ing}</b> ${ctx}.`;
                    // Neg and Q similarly
                    break;
                // Complete for others
                default: return "";
            }
            return sentence;
        }
        function createCard(title, struct, sentence, type, isAdvanced = false) {
            const cleanText = sentence.replace(/<[^>]*>/g, "");
            const timelineSVG = `<svg class="timeline"><line x1="0" y1="10" x2="100" y2="10" stroke="gray"/><circle cx="${type === 'past' ? 20 : type === 'future' ? 80 : 50}" cy="10" r="5" fill="var(--c-${type})"/></svg>`;
            return `
                <div class="card ${type} ${isAdvanced ? 'advanced' : ''}" onclick="speak('${cleanText}')">
                    <div class="tense-header"><span>${title}</span><button onclick="speak('${struct.replace(/ /g, ' ')}')">üîä</button></div>
                    ${timelineSVG}
                    <div class="conjugation">${struct}</div>
                    <div class="sentence-box"><div class="sentence-text">${sentence}</div></div>
                </div>
            `;
        }
        function speak(text) {
            // ... existing
        }
        function handleEnter(e) { if(e.key === 'Enter') teachVerb(); }
        // Search & Dropdown... existing, with input listener
        // Modal Logic Enhanced
        function showTheory(category) {
            // ... existing
            // Add rendering for commonErrors and timeExpressions
            data.forEach(t => {
                html += `
                // ... existing
                <span class="sub-label">Time Expressions</span>
                <div class="time-exp">${t.timeExpressions}</div>
                <span class="sub-label">Common Errors</span>
                <ul class="error-list">${t.commonErrors.map(err => `<li>${err}</li>`).join('')}</ul>
                `;
            });
            // ... 
        }
        // ... closeTheory existing
        // Render with Levels
        function teachVerb() {
            // ... existing
            const level = localStorage.getItem('userLevel') || 'beginner'; // Default beginner
            grid.classList.add(level);
            // In grid.innerHTML, mark perfect/perfect cont as advanced
            // Example:
            grid.innerHTML += createCard("Present Simple", /*...*/, false);
            grid.innerHTML += createCard("Present Perf. Cont.", /*...*/, true); // isAdvanced=true
            // Add quiz button
            document.getElementById('quizSection').style.display = 'block';
            startQuiz(d);
        }
        // Quiz Logic
        let currentQuiz = [];
        function startQuiz(d) {
            const quizContainer = document.getElementById('quizContainer');
            quizContainer.innerHTML = '';
            // Generate 5 questions
            for (let i = 0; i < 5; i++) {
                const tense = /* random tense */;
                const blankSentence = createSentence(tense, d).replace(/<b>.*<\/b>/, '<input class="quiz-input" type="text">');
                quizContainer.innerHTML += `<div class="quiz-card"><div class="quiz-question">${blankSentence} (${tense})</div></div>`;
                currentQuiz.push({ tense, correct: /* correct form */ });
            }
        }
        function checkQuiz() {
            const inputs = document.querySelectorAll('.quiz-input');
            let score = 0;
            inputs.forEach((input, i) => {
                if (input.value.trim().toLowerCase() === currentQuiz[i].correct.toLowerCase()) {
                    score++;
                    // Feedback
                } else {
                    // Error feedback, log for spaced repetition
                    localStorage.setItem(`struggle_${currentQuiz[i].tense}`, true);
                }
            });
            document.getElementById('quizFeedback').innerHTML = `Score: ${score}/5`;
            // Gamification: add points
            let totalScore = parseInt(localStorage.getItem('totalScore') || 0) + score;
            localStorage.setItem('totalScore', totalScore);
            document.getElementById('score').innerHTML = `Total Score: ${totalScore}`;
        }
        // Load last verb... existing
        // Add level selector if needed
    </script>
</body>
</html>
