<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Convertidor de subtítulos bilingües</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f8f9fa; }
    textarea { width: 100%; height: 300px; font-size: 16px; padding: 10px; }
    button { padding: 10px 20px; margin: 10px 5px 20px 0; font-size: 16px; }
    .output { background: white; padding: 20px; border: 1px solid #ddd; min-height: 100px; }
    .line { 
      margin: 20px 0; 
      padding: 15px; 
      background: #fff; 
      border-left: 5px solid #007cba; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .english { color: #2c3e50; font-weight: bold; margin-bottom: 8px; }
    .spanish { color: #c0392b; }
    .controls button { margin-right: 8px; padding: 6px 12px; }
  </style>
</head>
<body>

  <h1>Convertidor rápido a formato bilingüe</h1>
  <p>Pega tu texto con timestamps y pulsa “Convertir”.</p>

  <textarea id="inputText">[00:00](https://youtu.be/HAnw168huqA?t=0.091) [MUSIC] Welcome. I'm very excited today to talk about effective speaking in spontaneous situations. I thank you all for joining us, even though the title of my talk is grammatically incorrect.

[00:16](https://youtu.be/HAnw168huqA?t=16.83) I thought that might scare a few of you away. But I learned teaching here at the business school, catching people's attention is hard. So, something as simple as that, I thought, might draw a few of you here, so this is going to be a highly interactive and participative workshop today.

[00:35] Another paragraph example just to test multiple lines.

[01:12] And one more with a longer text that spans several sentences and even has a line break inside.</textarea>

  <br>
  <button onclick="convertir()">Convertir a formato HTML</button>
  <button onclick="document.getElementById('inputText').value = ''">Limpiar</button>
  <button onclick="copiar()">Copiar resultado</button>

  <h2>Resultado listo para copiar:</h2>
  <div id="resultado" class="output"></div>

  <script>
    function timeToSeconds(t) {
      const p = t.split(':').map(Number);
      if (p.length === 3) return p[0]*3600 + p[1]*60 + p[2];
      if (p.length === 2) return p[0]*60 + p[1];
      return 0;
    }

    function convertir() {
      const texto = document.getElementById('inputText').value;
      const bloques = texto.trim().split(/\n{2,}/); // separa por párrafos vacíos
      let html = '';

      bloques.forEach(bloque => {
        const lineas = bloque.trim().split('\n');
        const primeraLinea = lineas[0];

        // Busca [00:00] o [00:00:00]
        const match = primeraLinea.match(/\[((\d+:)?\d+:\d+)\]/);
        if (!match) return; // si no hay timestamp, ignora

        const tiempo = match[1];
        const segundos = timeToSeconds(tiempo);

        // Quita la primera línea (timestamp + posible link + [MUSIC])
        let ingles = bloque.replace(primeraLinea, '').trim();
        ingles = ingles.replace(/\[MUSIC\]/gi, '').replace(/^\s*[\r\n]/gm, '').trim();

        // Aquí debes escribir tú la traducción española correspondiente
        // (o usaré un diccionario simple para este ejemplo)
        const traducciones = {
          "Welcome. I'm very excited today to talk about effective speaking in spontaneous situations. I thank you all for joining us, even though the title of my talk is grammatically incorrect.": "Bienvenidos. Estoy muy emocionado hoy de hablar hoy sobre cómo hablar de forma efectiva en situaciones espontáneas. Gracias a todos por acompañarnos, aunque el título de mi charla esté gramaticalmente incorrecto.",
          "I thought that might scare a few of you away. But I learned teaching here at the business school, catching people's attention is hard. So, something as simple as that, I thought, might draw a few of you here, so this is going to be a highly interactive and participative workshop today.": "Pensé que eso podría ahuyentar a algunos. Pero aprendí enseñando en la escuela de negocios que captar la atención es difícil. Así que algo tan simple, pensé, podría atraer a algunos aquí. Será un taller muy interactivo y participativo.",
          "Another paragraph example just to test multiple lines.": "Otro ejemplo de párrafo solo para probar varias líneas.",
          "And one more with a longer text that spans several sentences and even has a line break inside.": "Y uno más con un texto más largo que abarca varias oraciones y hasta tiene un salto de línea dentro."
        };

        const spanish = traducciones[ingles] || "[Aquí va la traducción al español]";

        html += `<div class="line" data-time="${segundos}">
  <div class="line-content">
    <div class="text-block">
      <div class="english">${ingles.replace(/\n/g, '<br>')}</div>
      <div class="spanish">${spanish.replace(/\n/g, '<br>')}</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>\n\n`;
      });

      document.getElementById('resultado').innerHTML = html;
    }

    function copiar() {
      const rango = document.createRange();
      rango.selectNode(document.getElementById('resultado'));
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(rango);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      alert('¡Copiado al portapapeles!');
    }
  </script>

</body>
</html>
