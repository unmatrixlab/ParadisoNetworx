<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>12 English Tenses with "work" ‚Äì Afirmaci√≥n / Negaci√≥n / Pregunta</title>
  <style>
    :root{
      --bg: #0b1220;
      --card: #111a2b;
      --muted: #9fb0c6;
      --text: #e9f0ff;
      --accent: #7aa2ff;
      --accent-2: #8ef5d6;
      --ring: 0 0 0 2px rgba(122,162,255,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color:var(--text);
      background: radial-gradient(1200px 600px at 10% -10%, #1a2640 0%, transparent 60%),
                  radial-gradient(1200px 600px at 90% 10%, #16324a 0%, transparent 60%),
                  linear-gradient(180deg, #0b1220, #0b1220 40%, #0e1627);
    }
    header{
      position: sticky; top:0; z-index:50;
      backdrop-filter: blur(10px);
      background: rgba(11,18,32,.6);
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .wrap{max-width:1100px; margin:0 auto; padding:24px;}
    .title{display:flex; align-items:flex-end; gap:12px; flex-wrap:wrap}
    h1{font-size: clamp(20px, 3vw, 32px); margin:0}
    .subtitle{color:var(--muted); font-size:14px}

    .controls{
      display:flex; gap:16px; align-items:center; flex-wrap:wrap; margin-top:14px;
    }
    label{font-size:12px; color:var(--muted)}
    select, input[type="range"]{
      appearance:none; border:none; outline:none; color:var(--text);
      background: #0c1424; padding:10px 12px; border-radius:12px;
      border:1px solid rgba(255,255,255,.08);
    }
    .hint{font-size:12px; color:var(--muted)}

    main{padding: 18px 0 56px}
    .grid{
      display:grid; gap:18px;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    }
    .card{
      background: linear-gradient(180deg, #111a2b, #0f1726);
      border:1px solid rgba(255,255,255,.06);
      border-radius:18px; overflow:hidden; box-shadow: 0 10px 30px rgba(0,0,0,.35);
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .card:hover{ transform: translateY(-2px); box-shadow: 0 14px 36px rgba(0,0,0,.45); border-color: rgba(122,162,255,.25); }
    .card .head{ padding:16px 16px 10px; border-bottom:1px solid rgba(255,255,255,.06); background: linear-gradient(180deg, rgba(122,162,255,.08), transparent); cursor: pointer;}
    .card h2{ font-size:18px; margin:0 0 6px}
    .tags{display:flex; gap:8px; flex-wrap:wrap}
    .tag{font-size:11px; color:#091225; background: linear-gradient(180deg, var(--accent), var(--accent-2)); padding:6px 10px; border-radius:999px; font-weight:700; letter-spacing:.2px}

    .list{ padding: 10px 6px 12px }
    .row{ display:grid; grid-template-columns: 1fr auto; align-items:center; gap:8px; padding:6px 8px; border-radius:12px;}
    .row + .row{ margin-top:6px }
    .row:hover{ background: rgba(255,255,255,.04)}
    .label{ font-size:12px; color: var(--muted); margin-right:8px }
    .text{ font-size:15px; line-height:1.45 }

    .speak{
      display:inline-flex; align-items:center; gap:8px; cursor:pointer;
      border: 1px solid rgba(255,255,255,.1); background:#0d1628; color:var(--text);
      padding:8px 12px; border-radius:12px; font-weight:600; font-size:13px;
      transition: transform .12s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .speak:hover{ border-color: rgba(122,162,255,.4); box-shadow: var(--ring) }
    .speak:active{ transform: scale(.98) }
    .speak[aria-pressed="true"]{ border-color: rgba(142,245,214,.6) }

    .popup {
      display: none;
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: var(--card); border: 1px solid rgba(255,255,255,.1);
      border-radius: 12px; padding: 24px; max-width: 600px; width: 90%;
      box-shadow: 0 20px 40px rgba(0,0,0,.5); z-index: 100;
      max-height: 80vh; overflow-y: auto;
    }
    .popup-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .popup-header h3 { margin: 0; font-size: 20px; }
    .popup-close {
      cursor: pointer; background: none; border: none; color: var(--text);
      font-size: 18px; padding: 8px; line-height: 1;
    }
    .popup-content { font-size: 14px; line-height: 1.6; color: var(--text); }
    .popup-content h4 { margin: 16px 0 8px; font-size: 16px; }
    .popup-content ul { margin: 8px 0; padding-left: 20px; }
    .popup-content li { margin-bottom: 8px; }
    .overlay {
      display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,.7); z-index: 99;
    }

    .footer{max-width:1100px; margin: 22px auto; color:var(--muted); text-align:center; font-size:12px}
    .kbd{background:#0e1a31;border:1px solid rgba(255,255,255,.12); padding:2px 6px; border-radius:6px}
  </style>
</head>
<body>
  <div class="overlay" id="overlay"></div>
  <header>
    <div class="wrap">
      <div class="title">
        <h1>12 English Tenses with <em>work</em></h1>
        <span class="subtitle">Afirmaciones ‚úÖ ‚Ä¢ Negaciones ‚ùå ‚Ä¢ Preguntas ‚ùì ‚Äî con bot√≥n lector junto a cada frase</span>
      </div>
      <div class="controls">
        <div>
          <label for="voice">Voz:</label><br>
          <select id="voice" aria-label="Seleccionar voz"></select>
        </div>
        <div>
          <label for="rate">Velocidad: <span id="rateVal">1.0</span>x</label><br>
          <input id="rate" type="range" min="0.6" max="1.4" step="0.05" value="1.0" />
        </div>
        <div>
          <label for="pitch">Tono: <span id="pitchVal">1.0</span></label><br>
          <input id="pitch" type="range" min="0.7" max="1.3" step="0.05" value="1.0" />
        </div>
        <button id="stopAll" class="speak" title="Detener lectura">‚èπÔ∏è Detener todo</button>
        <span class="hint">Consejo: haz clic en el bot√≥n üîä para escuchar la frase en ingl√©s o en el t√≠tulo del tiempo verbal para una explicaci√≥n detallada.</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid" id="cards">

      <!-- 1. Present Simple -->
      <article class="card" data-tense="present-simple">
        <div class="head">
          <h2>1) Present Simple</h2>
          <div class="tags"><span class="tag">habit / fact</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I work every day.</div>
            <button class="speak" data-utterance="I work every day.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I don‚Äôt work on Sundays.</div>
            <button class="speak" data-utterance="I don't work on Sundays.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Do you work here?</div>
            <button class="speak" data-utterance="Do you work here?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 2. Present Continuous -->
      <article class="card" data-tense="present-continuous">
        <div class="head">
          <h2>2) Present Continuous</h2>
          <div class="tags"><span class="tag">now / in progress</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I am working right now.</div>
            <button class="speak" data-utterance="I am working right now.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I am not working at the moment.</div>
            <button class="speak" data-utterance="I am not working at the moment.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Are you working today?</div>
            <button class="speak" data-utterance="Are you working today?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 3. Present Perfect -->
      <article class="card" data-tense="present-perfect">
        <div class="head">
          <h2>3) Present Perfect</h2>
          <div class="tags"><span class="tag">past ‚Üí present</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I have worked here since 2010.</div>
            <button class="speak" data-utterance="I have worked here since twenty ten.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I haven‚Äôt worked there before.</div>
            <button class="speak" data-utterance="I haven't worked there before.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Have you worked in this company?</div>
            <button class="speak" data-utterance="Have you worked in this company?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 4. Present Perfect Continuous -->
      <article class="card" data-tense="present-perfect-continuous">
        <div class="head">
          <h2>4) Present Perfect Continuous</h2>
          <div class="tags"><span class="tag">duration</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I have been working all morning.</div>
            <button class="speak" data-utterance="I have been working all morning.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I haven‚Äôt been working much lately.</div>
            <button class="speak" data-utterance="I haven't been working much lately.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Have you been working hard today?</div>
            <button class="speak" data-utterance="Have you been working hard today?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 5. Past Simple -->
      <article class="card" data-tense="past-simple">
        <div class="head">
          <h2>5) Past Simple</h2>
          <div class="tags"><span class="tag">finished past</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I worked yesterday.</div>
            <button class="speak" data-utterance="I worked yesterday.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I didn‚Äôt work last night.</div>
            <button class="speak" data-utterance="I didn't work last night.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Did you work last week?</div>
            <button class="speak" data-utterance="Did you work last week?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 6. Past Continuous -->
      <article class="card" data-tense="past-continuous">
        <div class="head">
          <h2>6) Past Continuous</h2>
          <div class="tags"><span class="tag">past in progress</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I was working when you called.</div>
            <button class="speak" data-utterance="I was working when you called.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I wasn‚Äôt working at that time.</div>
            <button class="speak" data-utterance="I wasn't working at that time.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Were you working last night?</div>
            <button class="speak" data-utterance="Were you working last night?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 7. Past Perfect -->
      <article class="card" data-tense="past-perfect">
        <div class="head">
          <h2>7) Past Perfect</h2>
          <div class="tags"><span class="tag">past before past</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I had worked before I moved here.</div>
            <button class="speak" data-utterance="I had worked before I moved here.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I hadn‚Äôt worked in that field before.</div>
            <button class="speak" data-utterance="I hadn't worked in that field before.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Had you worked there before the crisis?</div>
            <button class="speak" data-utterance="Had you worked there before the crisis?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 8. Past Perfect Continuous -->
      <article class="card" data-tense="past-perfect-continuous">
        <div class="head">
          <h2>8) Past Perfect Continuous</h2>
          <div class="tags"><span class="tag">duration before past</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I had been working for two hours when she arrived.</div>
            <button class="speak" data-utterance="I had been working for two hours when she arrived.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I hadn‚Äôt been working long before the meeting.</div>
            <button class="speak" data-utterance="I hadn't been working long before the meeting.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Had you been working all day before you left?</div>
            <button class="speak" data-utterance="Had you been working all day before you left?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 9. Future Simple (Will) -->
      <article class="card" data-tense="future-simple">
        <div class="head">
          <h2>9) Future Simple (will)</h2>
          <div class="tags"><span class="tag">prediction / decision</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I will work tomorrow.</div>
            <button class="speak" data-utterance="I will work tomorrow.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I won‚Äôt work next Sunday.</div>
            <button class="speak" data-utterance="I won't work next Sunday.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Will you work next week?</div>
            <button class="speak" data-utterance="Will you work next week?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 10. Future Continuous -->
      <article class="card" data-tense="future-continuous">
        <div class="head">
          <h2>10) Future Continuous</h2>
          <div class="tags"><span class="tag">future in progress</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I will be working at 8 pm.</div>
            <button class="speak" data-utterance="I will be working at eight p.m.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I won‚Äôt be working at that time.</div>
            <button class="speak" data-utterance="I won't be working at that time.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Will you be working late tonight?</div>
            <button class="speak" data-utterance="Will you be working late tonight?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 11. Future Perfect -->
      <article class="card" data-tense="future-perfect">
        <div class="head">
          <h2>11) Future Perfect</h2>
          <div class="tags"><span class="tag">completed by a time</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I will have worked 10 hours by 6 pm.</div>
            <button class="speak" data-utterance="I will have worked ten hours by six p.m.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I won‚Äôt have worked enough by then.</div>
            <button class="speak" data-utterance="I won't have worked enough by then.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Will you have worked 40 hours by Friday?</div>
            <button class="speak" data-utterance="Will you have worked forty hours by Friday?">üîä Leer</button>
          </div>
        </div>
      </article>

      <!-- 12. Future Perfect Continuous -->
      <article class="card" data-tense="future-perfect-continuous">
        <div class="head">
          <h2>12) Future Perfect Continuous</h2>
        <div class="tags"><span class="tag">duration to a time</span></div>
        </div>
        <div class="list">
          <div class="row">
            <div class="text"><span class="label">‚úÖ</span> I will have been working for 5 years by next June.</div>
            <button class="speak" data-utterance="I will have been working for five years by next June.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùå</span> I won‚Äôt have been working here that long.</div>
            <button class="speak" data-utterance="I won't have been working here that long.">üîä Leer</button>
          </div>
          <div class="row">
            <div class="text"><span class="label">‚ùì</span> Will you have been working here for 10 years by 2030?</div>
            <button class="speak" data-utterance="Will you have been working here for ten years by twenty thirty?">üîä Leer</button>
          </div>
        </div>
      </article>

    </div>
  </main>

  <div class="popup" id="tensePopup">
    <div class="popup-header">
      <h3 id="popupTitle"></h3>
      <button class="popup-close" id="closePopup">‚úï</button>
    </div>
    <div class="popup-content" id="popupContent"></div>
  </div>

  <div class="footer">
    Hecho con ‚ô• ‚Äî Sugerencia: pulsa <span class="kbd">‚èπÔ∏è Detener todo</span> si una voz se queda en cola.
  </div>

  <script>
    (function(){
      const voiceSelect = document.getElementById('voice');
      const rate = document.getElementById('rate');
      const pitch = document.getElementById('pitch');
      const rateVal = document.getElementById('rateVal');
      const pitchVal = document.getElementById('pitchVal');
      const stopAll = document.getElementById('stopAll');
      const overlay = document.getElementById('overlay');
      const tensePopup = document.getElementById('tensePopup');
      const popupTitle = document.getElementById('popupTitle');
      const popupContent = document.getElementById('popupContent');
      const closePopup = document.getElementById('closePopup');

      const preferLangs = ['en-US','en-GB','en-AU','en-CA','en-IN'];
      let voices = [];

      const tenseExplanations = {
        'present-simple': {
          title: 'Present Simple',
          content: `
            <h4>Overview</h4>
            <p>The Present Simple is used to describe habits, general truths, routines, and facts that are always or generally true.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + base verb (add -s or -es for third person singular)</li>
              <li><strong>Negative</strong>: Subject + do/does + not + base verb</li>
              <li><strong>Question</strong>: Do/Does + subject + base verb?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Habits and routines: <em>I work every day.</em></li>
              <li>General facts: <em>The sun rises in the east.</em></li>
              <li>Scheduled events: <em>The train leaves at 7 PM.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>She works in a hospital.</li>
              <li>They don‚Äôt play football on Sundays.</li>
              <li>Does he work here?</li>
            </ul>`
        },
        'present-continuous': {
          title: 'Present Continuous',
          content: `
            <h4>Overview</h4>
            <p>The Present Continuous describes actions happening right now or temporary situations.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + am/is/are + verb + -ing</li>
              <li><strong>Negative</strong>: Subject + am/is/are + not + verb + -ing</li>
              <li><strong>Question</strong>: Am/Is/Are + subject + verb + -ing?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Actions happening now: <em>I am working right now.</em></li>
              <li>Temporary actions: <em>She is living in London this year.</em></li>
              <li>Future plans: <em>We are meeting tomorrow.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>He is studying for his exams.</li>
              <li>They aren‚Äôt working today.</li>
              <li>Are you coming to the party?</li>
            </ul>`
        },
        'present-perfect': {
          title: 'Present Perfect',
          content: `
            <h4>Overview</h4>
            <p>The Present Perfect connects past actions to the present, often focusing on experience or results.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + have/has + past participle</li>
              <li><strong>Negative</strong>: Subject + have/has + not + past participle</li>
              <li><strong>Question</strong>: Have/Has + subject + past participle?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Life experiences: <em>I have worked here since 2010.</em></li>
              <li>Completed actions with present relevance: <em>She has just finished her homework.</em></li>
              <li>Unspecified time: <em>Have you ever worked abroad?</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>We have seen that movie.</li>
              <li>He hasn‚Äôt visited Paris.</li>
              <li>Have they finished the project?</li>
            </ul>`
        },
        'present-perfect-continuous': {
          title: 'Present Perfect Continuous',
          content: `
            <h4>Overview</h4>
            <p>The Present Perfect Continuous emphasizes the duration or ongoing nature of an action that started in the past and continues to the present.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + have/has + been + verb + -ing</li>
              <li><strong>Negative</strong>: Subject + have/has + not + been + verb + -ing</li>
              <li><strong>Question</strong>: Have/Has + subject + been + verb + -ing?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Ongoing actions with duration: <em>I have been working all morning.</em></li>
              <li>Actions with visible results: <em>She‚Äôs tired because she has been working hard.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>They have been studying for hours.</li>
              <li>I haven‚Äôt been feeling well lately.</li>
              <li>Have you been working on this project?</li>
            </ul>`
        },
        'past-simple': {
          title: 'Past Simple',
          content: `
            <h4>Overview</h4>
            <p>The Past Simple describes actions that are completed in the past at a specific time.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + past verb (regular: -ed; irregular: 2nd form)</li>
              <li><strong>Negative</strong>: Subject + did + not + base verb</li>
              <li><strong>Question</strong>: Did + subject + base verb?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Completed actions: <em>I worked yesterday.</em></li>
              <li>Past habits: <em>We played soccer every weekend.</em></li>
              <li>Sequential events: <em>She arrived, ate, and left.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>He visited London last year.</li>
              <li>They didn‚Äôt go to the party.</li>
              <li>Did you see the movie?</li>
            </ul>`
        },
        'past-continuous': {
          title: 'Past Continuous',
          content: `
            <h4>Overview</h4>
            <p>The Past Continuous describes actions that were in progress at a specific time in the past.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + was/were + verb + -ing</li>
              <li><strong>Negative</strong>: Subject + was/were + not + verb + -ing</li>
              <li><strong>Question</strong>: Was/Were + subject + verb + -ing?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Ongoing past actions: <em>I was working when you called.</em></li>
              <li>Background actions: <em>It was raining while we were eating.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>She was reading a book.</li>
              <li>They weren‚Äôt listening to music.</li>
              <li>Were you sleeping at 10 PM?</li>
            </ul>`
        },
        'past-perfect': {
          title: 'Past Perfect',
          content: `
ennio
            <h4>Overview</h4>
            <p>The Past Perfect describes actions that were completed before another past action.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + had + past participle</li>
              <li><strong>Negative</strong>: Subject + had + not + past participle</li>
              <li><strong>Question</strong>: Had + subject + past participle?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Past before past: <em>I had worked before I moved here.</em></li>
              <li>Cause and effect: <em>She was tired because she had worked all day.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>They had finished the project before the deadline.</li>
              <li>He hadn‚Äôt eaten before the meeting.</li>
              <li>Had you seen her before?</li>
            </ul>`
        },
        'past-perfect-continuous': {
          title: 'Past Perfect Continuous',
          content: `
            <h4>Overview</h4>
            <p>The Past Perfect Continuous emphasizes the duration of an action that was ongoing before another past action.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + had + been + verb + -ing</li>
              <li><strong>Negative</strong>: Subject + had + not + been + verb + -ing</li>
              <li><strong>Question</strong>: Had + subject + been + verb + -ing?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Duration before a past event: <em>I had been working for two hours when she arrived.</em></li>
              <li>Cause of a past situation: <em>He was exhausted because he had been working all night.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>They had been studying for weeks before the exam.</li>
              <li>She hadn‚Äôt been sleeping well.</li>
              <li>Had you been waiting long?</li>
            </ul>`
        },
        'future-simple': {
          title: 'Future Simple (will)',
          content: `
            <h4>Overview</h4>
            <p>The Future Simple expresses predictions, spontaneous decisions, or promises about the future.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + will + base verb</li>
              <li><strong>Negative</strong>: Subject + will + not + base verb</li>
              <li><strong>Question</strong>: Will + subject + base verb?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Predictions: <em>It will rain tomorrow.</em></li>
              <li>Spontaneous decisions: <em>I will work tomorrow.</em></li>
              <li>Promises: <em>I will help you later.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>She will call you soon.</li>
              <li>They won‚Äôt come to the party.</li>
              <li>Will he join us?</li>
            </ul>`
        },
        'future-continuous': {
          title: 'Future Continuous',
          content: `
            <h4>Overview</h4>
            <p>The Future Continuous describes actions that will be in progress at a specific time in the future.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + will + be + verb + -ing</li>
              <li><strong>Negative</strong>: Subject + will + not + be + verb + -ing</li>
              <li><strong>Question</strong>: Will + subject + be + verb + -ing?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Ongoing future actions: <em>I will be working at 8 PM.</em></li>
              <li>Polite inquiries: <em>Will you be working late tonight?</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>They will be traveling tomorrow.</li>
              <li>She won‚Äôt be attending the meeting.</li>
              <li>Will you be staying here?</li>
            </ul>`
        },
        'future-perfect': {
          title: 'Future Perfect',
          content: `
            <h4>Overview</h4>
            <p>The Future Perfect describes actions that will be completed by a specific time in the future.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + will + have + past participle</li>
              <li><strong>Negative</strong>: Subject + will + not + have + past participle</li>
              <li><strong>Question</strong>: Will + subject + have + past participle?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Completion by a future time: <em>I will have worked 10 hours by 6 PM.</em></li>
              <li>Expected outcomes: <em>She will have finished the report by tomorrow.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>They will have completed the project by next week.</li>
              <li>He won‚Äôt have arrived by then.</li>
              <li>Will you have finished by 5 PM?</li>
            </ul>`
        },
        'future-perfect-continuous': {
          title: 'Future Perfect Continuous',
          content: `
            <h4>Overview</h4>
            <p>The Future Perfect Continuous emphasizes the duration of an action up to a specific point in the future.</p>
            <h4>Structure</h4>
            <ul>
              <li><strong>Affirmative</strong>: Subject + will + have + been + verb + -ing</li>
              <li><strong>Negative</strong>: Subject + will + not + have + been + verb + -ing</li>
              <li><strong>Question</strong>: Will + subject + have + been + verb + -ing?</li>
            </ul>
            <h4>Usage</h4>
            <ul>
              <li>Duration until a future point: <em>I will have been working for 5 years by next June.</em></li>
              <li>Cause of future state: <em>She will be tired because she will have been working all day.</em></li>
            </ul>
            <h4>Examples</h4>
            <ul>
              <li>They will have been studying for months by the exam date.</li>
              <li>I won‚Äôt have been living here long by then.</li>
              <li>Will you have been working here for a year by December?</li>
            </ul>`
        }
      };

      function populateVoices(){
        voices = speechSynthesis.getVoices();
        voices.sort((a,b)=>{
          const ai = preferLangs.indexOf(a.lang);
          const bi = preferLangs.indexOf(b.lang);
          return (ai === -1 ? 999 : ai) - (bi === -1 ? 999 : bi) || a.name.localeCompare(b.name);
        });
        voiceSelect.innerHTML = '';
        voices.forEach((v,i)=>{
          const opt = document.createElement('option');
          opt.value = i;
          opt.textContent = `${v.name} (${v.lang})${v.default ? ' ‚Äî default' : ''}`;
          voiceSelect.appendChild(opt);
        });
        const idx = voices.findIndex(v => preferLangs.includes(v.lang));
        voiceSelect.value = String(idx > -1 ? idx : 0);
      }

      if (typeof speechSynthesis !== 'undefined'){
        populateVoices();
        if (speechSynthesis.onvoiceschanged !== undefined){
          speechSynthesis.onvoiceschanged = populateVoices;
        }
      }

      function speak(text){
        if (!('speechSynthesis' in window)){
          alert('Tu navegador no soporta Speech Synthesis. Prueba con Chrome, Edge o Safari.');
          return;
        }
        speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        const v = voices[parseInt(voiceSelect.value,10)];
        if (v) u.voice = v;
        u.lang = (v && v.lang) || 'en-US';
        u.rate = parseFloat(rate.value);
        u.pitch = parseFloat(pitch.value);
        speechSynthesis.speak(u);
      }

      function showPopup(tense) {
        const explanation = tenseExplanations[tense];
        if (explanation) {
          popupTitle.textContent = explanation.title;
          popupContent.innerHTML = explanation.content;
          tensePopup.style.display = 'block';
          overlay.style.display = 'block';
        }
      }

      function closePopupFn() {
        tensePopup.style.display = 'none';
        overlay.style.display = 'none';
      }

      document.querySelectorAll('.card .head').forEach(head => {
        head.addEventListener('click', () => {
          const tense = head.closest('.card').dataset.tense;
          showPopup(tense);
        });
      });

      closePopup.addEventListener('click', closePopupFn);
      overlay.addEventListener('click', closePopupFn);

      document.querySelectorAll('.speak').forEach(btn =>{
        btn.addEventListener('click', ()=>{
          const txt = btn.getAttribute('data-utterance');
          document.querySelectorAll('.speak[aria-pressed="true"]').forEach(b=>b.setAttribute('aria-pressed','false'));
          btn.setAttribute('aria-pressed','true');
          speak(txt);
          const id = setInterval(()=>{
            if (!speechSynthesis.speaking){
              btn.setAttribute('aria-pressed','false');
              clearInterval(id);
            }
          }, 150);
        });
      });

      stopAll.addEventListener('click', ()=> speechSynthesis.cancel());

      rate.addEventListener('input', ()=> rateVal.textContent = rate.value);
      pitch.addEventListener('input', ()=> pitchVal.textContent = pitch.value);
    })();
  </script>
</body>
</html>
