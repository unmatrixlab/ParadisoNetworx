<script>
// ====== ENCABEZADO PEQUEÑO PARA MDC ENG ======
const HEADER_TEXT   = "MDC ENG";
const HOME_URL      = "https://paradisonetworx.com/mdceng";
const HEADER_HEIGHT = "27px";     // ← tu altura actual
const BG_COLOR      = "rgba(0, 0, 0, 0.8)";
const TEXT_COLOR    = "#ffffff";
const FONT_SIZE     = "17px";

function createSmallHeader() {
  if (document.getElementById('mdc-small-header')) return;

  const header = document.createElement('div');
  header.id = 'mdc-small-header';
  header.innerHTML = `<a href="${HOME_URL}" style="color:${TEXT_COLOR}; text-decoration:none; font-weight:bold; font-size:${FONT_SIZE}; font-family:Arial,Helvetica,sans-serif;">${HEADER_TEXT}</a>`;
  
  header.style.cssText = `
    position: fixed;
    top: 0; left: 0; width: 100%; height: ${HEADER_HEIGHT};
    background: ${BG_COLOR};
    z-index: 9999;
    display: flex; align-items: center; justify-content: center;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  `;

  // Insertar el header
  document.body.insertBefore(header, document.body.firstChild);

  // ← AQUÍ ESTÁ LA CLAVE: forzar margen/padding en TODOS los elementos hijos del body
  document.body.style.cssText += `
    margin-top: ${HEADER_HEIGHT} !important;
    padding-top: ${HEADER_HEIGHT} !important;
  `;

  // Extra seguridad: también empujar el primer elemento visible (por si hay divs con position absolute, etc.)
  const firstContent = document.body.firstElementChild;
  if (firstContent && firstContent !== header) {
    firstContent.style.marginTop = HEADER_HEIGHT;
  }
}

// Ejecutar inmediatamente o cuando cargue el DOM
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', createSmallHeader);
} else {
  createSmallHeader();
}
</script>

<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Anne Hathaway × Aprende Inglés</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #6366f1;
    --primary-dark: #4f46e5;
    --primary-light: #818cf8;
    --gray-100: #f8fafc;
    --gray-200: #e2e8f0;
    --gray-600: #475569;
    --gray-800: #1e293b;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
    --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
    --shadow-lg: 0 10px 30px rgba(0,0,0,0.15);
    --radius: 16px;
    --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: linear-gradient(135deg, #eef2ff 0%, #ddd6fe 100%);
    color: var(--gray-800);
    line-height: 1.6;
    min-height: 100vh;
  }

  /* ====== LA CLAVE: CONTENEDOR QUE LIMITA EL ANCHO EN DESKTOP ====== */
  .page-max-width {
    max-width: 580px;           /* ancho ideal para lectura cómoda */
    margin: 0 auto;             /* centrado perfecto */
    width: 100%;
  }
  @media (max-width: 768px) {
    .page-max-width {
      max-width: 100%;          /* en móvil vuelve a ocupar todo */
    }
  }

  /* ====================== VIDEO FIJO ====================== */
  .video-wrapper {
    position: sticky;
    top: 0;
    width: 100%;
    background: #000;
    z-index: 20;
    box-shadow: var(--shadow-lg);
    max-height: 65vh;
    min-height: 280px;
    border-bottom: 4px solid var(--primary);
  }
  .video-inner {
    position: relative;
    width: 100%;
    height: 0;
    padding-bottom: 56.25%;
    border-radius: 0 0 var(--radius) var(--radius);
    overflow: hidden;
  }
  .video-inner iframe {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    border: none;
  }
  .spacer { height: 12vh; }
  @media (max-width: 640px) { .spacer { height: 6vh; } }

  /* ====================== CONTENEDOR DE TARJETAS ====================== */
  .dialogue-container {
    padding: 24px 20px;
  }

  /* ====================== TARJETAS ====================== */
  .line {
    background: white;
    padding: 24px;
    margin-bottom: 20px;
    border-radius: var(--radius);
    box-shadow: var(--shadow-md);
    transition: var(--transition);
    border-left: 5px solid transparent;
  }
  .line:hover {
    transform: translateY(-6px);
    box-shadow: var(--shadow-lg);
  }
  .line.active {
    border-left-color: var(--primary);
    background: #f8faff;
    box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
  }
  .line-content {
    display: flex;
    align-items: center;
    gap: 20px;
  }
  .text-block {
    flex: 1;
    cursor: pointer;
    user-select: none;
  }
  .english {
    font-size: 18px;
    font-weight: 600;
    color: var(--gray-800);
    line-height: 1.6;
    margin-bottom: 8px;
  }
  .spanish {
    font-size: 16px;
    color: var(--gray-600);
    font-weight: 500;
    line-height: 1.6;
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    transition: var(--transition);
  }
  .spanish.visible {
    opacity: 1;
    max-height: 200px;
    margin-top: 12px;
  }
  .controls {
    display: flex;
    flex-direction: column;
    gap: 12px;
    min-width: 100px;
  }
  .btn {
    padding: 12px 16px;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--shadow-sm);
  }
  .playBtn {
    background: var(--primary);
    color: white;
  }
  .playBtn:hover { background: var(--primary-dark); transform: translateY(-1px); }
  .speakBtn {
    background: var(--gray-200);
    color: var(--gray-800);
  }
  .speakBtn:hover { background: #cbd5e1; }
  .playBtn[data-playing="true"] { background: #dc2626; }
  .speakBtn[data-speaking="true"] { background: #dc2626; color: white; }

  /* ====================== RESPONSIVE ====================== */
  @media (max-width: 640px) {
    .dialogue-container { padding: 16px 12px; }
    .line { padding: 20px; }
    .line-content {
      flex-direction: column;
      text-align: center;
      gap: 16px;
    }
    .controls {
      flex-direction: row;
      width: 100%;
      justify-content: center;
    }
    .btn { flex: 1; }
    .english { font-size: 17px; }
  }
  @media (max-height: 600px) and (min-width: 1000px) {
    .video-wrapper { max-height: 55vh; }
  }
</style>
</head>
<body>

  <!-- CONTENEDOR QUE LIMITA EL ANCHO EN DESKTOP -->
  <div class="page-max-width">

    <div class="video-wrapper">
      <div class="video-inner">
        <div id="player"></div>
      </div>
    </div>

    <div class="spacer"></div>

    <div class="dialogue-container">

      <!-- TODAS TUS LÍNEAS AQUÍ (solo pongo las primeras y últimas para no hacer el mensaje eterno) -->

<div class="line" data-time="12">
  <div class="line-content">
    <div class="text-block">
      <div class="english">When I was first learning to meditate,</div>
      <div class="spanish">Cuando estaba aprendiendo a meditar por primera vez,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="14">
  <div class="line-content">
    <div class="text-block">
      <div class="english">the instruction was to simply pay attention to my breath,</div>
      <div class="spanish">la instrucción era simplemente prestar atención a mi respiración,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="17">
  <div class="line-content">
    <div class="text-block">
      <div class="english">and when my mind wandered, to bring it back.</div>
      <div class="spanish">y cuando mi mente se dispersaba, volver a traerla.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="20">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Sounded simple enough.</div>
      <div class="spanish">Sonaba bastante simple.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="22">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Yet I'd sit on these silent retreats,</div>
      <div class="spanish">Sin embargo, me sentaba en estos retiros silenciosos,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="25">
  <div class="line-content">
    <div class="text-block">
      <div class="english">sweating through T-shirts in the middle of winter.</div>
      <div class="spanish">sudando a través de las camisetas en pleno invierno.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="29">
  <div class="line-content">
    <div class="text-block">
      <div class="english">I'd take naps every chance I got because it was really hard work.</div>
      <div class="spanish">Dormía la siesta cada vez que podía porque era un trabajo realmente duro.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="32">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Actually, it was exhausting.</div>
      <div class="spanish">En realidad, era agotador.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="35">
  <div class="line-content">
    <div class="text-block">
      <div class="english">The instruction was simple enough</div>
      <div class="spanish">La instrucción era bastante simple</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="37">
  <div class="line-content">
    <div class="text-block">
      <div class="english">but I was missing something really important.</div>
      <div class="spanish">pero me estaba perdiendo algo realmente importante.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="40">
  <div class="line-content">
    <div class="text-block">
      <div class="english">So why is it so hard to pay attention?</div>
      <div class="spanish">Entonces, ¿por qué es tan difícil prestar atención?</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="43">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Well, studies show</div>
      <div class="spanish">Bueno, los estudios muestran</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="44">
  <div class="line-content">
    <div class="text-block">
      <div class="english">that even when we're really trying to pay attention to something --</div>
      <div class="spanish">que incluso cuando realmente estamos intentando prestar atención a algo —</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="47">
  <div class="line-content">
    <div class="text-block">
      <div class="english">like maybe this talk --</div>
      <div class="spanish">como quizás esta charla —</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="49">
  <div class="line-content">
    <div class="text-block">
      <div class="english">at some point,</div>
      <div class="spanish">en algún momento,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="50">
  <div class="line-content">
    <div class="text-block">
      <div class="english">about half of us will drift off into a daydream,</div>
      <div class="spanish">aproximadamente la mitad de nosotros nos perderemos en un ensueño,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="52">
  <div class="line-content">
    <div class="text-block">
      <div class="english">or have this urge to check our Twitter feed.</div>
      <div class="spanish">o tendremos esta urgencia de revisar nuestro feed de Twitter.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="56">
  <div class="line-content">
    <div class="text-block">
      <div class="english">So what's going on here?</div>
      <div class="spanish">Entonces, ¿qué está pasando aquí?</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="59">
  <div class="line-content">
    <div class="text-block">
      <div class="english">It turns out that we're fighting one of the most evolutionarily-conserved</div>
      <div class="spanish">Resulta que estamos luchando contra uno de los procesos de aprendizaje más conservados evolutivamente</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="62">
  <div class="line-content">
    <div class="text-block">
      <div class="english">learning processes currently known in science,</div>
      <div class="spanish">conocidos actualmente en la ciencia,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="65">
  <div class="line-content">
    <div class="text-block">
      <div class="english">one that's conserved</div>
      <div class="spanish">uno que se conserva</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="66">
  <div class="line-content">
    <div class="text-block">
      <div class="english">back to the most basic nervous systems known to man.</div>
      <div class="spanish">desde los sistemas nerviosos más básicos conocidos por el ser humano.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="69">
  <div class="line-content">
    <div class="text-block">
      <div class="english">This reward-based learning process</div>
      <div class="spanish">Este proceso de aprendizaje basado en recompensas</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="71">
  <div class="line-content">
    <div class="text-block">
      <div class="english">is called positive and negative reinforcement,</div>
      <div class="spanish">se llama refuerzo positivo y negativo,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="73">
  <div class="line-content">
    <div class="text-block">
      <div class="english">and basically goes like this.</div>
      <div class="spanish">y básicamente funciona así.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="76">
  <div class="line-content">
    <div class="text-block">
      <div class="english">We see some food that looks good,</div>
      <div class="spanish">Vemos comida que se ve buena,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="77">
  <div class="line-content">
    <div class="text-block">
      <div class="english">our brain says, "Calories! ... Survival!"</div>
      <div class="spanish">nuestro cerebro dice: "¡Calorías! ¡Supervivencia!"</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="80">
  <div class="line-content">
    <div class="text-block">
      <div class="english">We eat the food, we taste it -- it tastes good.</div>
      <div class="spanish">Comemos la comida, la probamos — sabe bien.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="82">
  <div class="line-content">
    <div class="text-block">
      <div class="english">And especially with sugar,</div>
      <div class="spanish">Y especialmente con el azúcar,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="84">
  <div class="line-content">
    <div class="text-block">
      <div class="english">our bodies send a signal to our brain that says,</div>
      <div class="spanish">nuestros cuerpos envían una señal al cerebro que dice:</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="87">
  <div class="line-content">
    <div class="text-block">
      <div class="english">"Remember what you're eating and where you found it."</div>
      <div class="spanish">"Recuerda qué estás comiendo y dónde lo encontraste."</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="91">
  <div class="line-content">
    <div class="text-block">
      <div class="english">We lay down this context-dependent memory</div>
      <div class="spanish">Creamos este recuerdo dependiente del contexto</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="94">
  <div class="line-content">
    <div class="text-block">
      <div class="english">and learn to repeat the process next time.</div>
      <div class="spanish">y aprendemos a repetir el proceso la próxima vez.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="96">
  <div class="line-content">
    <div class="text-block">
      <div class="english">See food,</div>
      <div class="spanish">Ver comida,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="97">
  <div class="line-content">
    <div class="text-block">
      <div class="english">eat food, feel good,</div>
      <div class="spanish">comer comida, sentirse bien,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="99">
  <div class="line-content">
    <div class="text-block">
      <div class="english">repeat.</div>
      <div class="spanish">repetir.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="101">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Trigger, behavior, reward.</div>
      <div class="spanish">Desencadenante, conducta, recompensa.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="105">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Simple, right?</div>
      <div class="spanish">Simple, ¿verdad?</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="105">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Well, after a while, our creative brains say,</div>
      <div class="spanish">Bueno, después de un tiempo, nuestros cerebros creativos dicen:</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="108">
  <div class="line-content">
    <div class="text-block">
      <div class="english">"You know what?</div>
      <div class="spanish">"¿Sabes qué?</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="109">
  <div class="line-content">
    <div class="text-block">
      <div class="english">You can use this for more than just remembering where food is.</div>
      <div class="spanish">Puedes usar esto para algo más que solo recordar dónde está la comida.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="112">
  <div class="line-content">
    <div class="text-block">
      <div class="english">You know, next time you feel bad,</div>
      <div class="spanish">Sabes, la próxima vez que te sientas mal,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="115">
  <div class="line-content">
    <div class="text-block">
      <div class="english">why don't you try eating something good so you'll feel better?"</div>
      <div class="spanish">¿por qué no pruebas comer algo rico para sentirte mejor?"</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="119">
  <div class="line-content">
    <div class="text-block">
      <div class="english">We thank our brains for the great idea,</div>
      <div class="spanish">Agradecemos a nuestro cerebro la gran idea,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="121">
  <div class="line-content">
    <div class="text-block">
      <div class="english">try this and quickly learn</div>
      <div class="spanish">lo probamos y rápidamente aprendemos</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="123">
  <div class="line-content">
    <div class="text-block">
      <div class="english">that if we eat chocolate or ice cream when we're mad or sad,</div>
      <div class="spanish">que si comemos chocolate o helado cuando estamos enojados o tristes,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="126">
  <div class="line-content">
    <div class="text-block">
      <div class="english">we feel better.</div>
      <div class="spanish">nos sentimos mejor.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="128">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Same process,</div>
      <div class="spanish">Mismo proceso,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="130">
  <div class="line-content">
    <div class="text-block">
      <div class="english">just a different trigger.</div>
      <div class="spanish">solo un desencadenante diferente.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="131">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Instead of this hunger signal coming from our stomach,</div>
      <div class="spanish">En lugar de esta señal de hambre que viene del estómago,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="134">
  <div class="line-content">
    <div class="text-block">
      <div class="english">this emotional signal -- feeling sad --</div>
      <div class="spanish">esta señal emocional —sentirse triste—</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="136">
  <div class="line-content">
    <div class="text-block">
      <div class="english">triggers that urge to eat.</div>
      <div class="spanish">desencadena esa urgencia de comer.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="139">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Maybe in our teenage years,</div>
      <div class="spanish">Tal vez en nuestra adolescencia,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="141">
  <div class="line-content">
    <div class="text-block">
      <div class="english">we were a nerd at school,</div>
      <div class="spanish">éramos unos nerds en la escuela,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="143">
  <div class="line-content">
    <div class="text-block">
      <div class="english">and we see those rebel kids outside smoking and we think,</div>
      <div class="spanish">y veíamos a esos chicos rebeldes fumando afuera y pensábamos:</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="146">
  <div class="line-content">
    <div class="text-block">
      <div class="english">"Hey, I want to be cool."</div>
      <div class="spanish">"Oye, yo quiero ser cool."</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="147">
  <div class="line-content">
    <div class="text-block">
      <div class="english">So we start smoking.</div>
      <div class="spanish">Así que empezamos a fumar.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="149">
  <div class="line-content">
    <div class="text-block">
      <div class="english">The Marlboro Man wasn't a dork,</div>
      <div class="spanish">El Hombre Marlboro no era un nerd,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="153">
  <div class="line-content">
    <div class="text-block">
      <div class="english">and that was no accident.</div>
      <div class="spanish">y eso no era casualidad.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="153">
  <div class="line-content">
    <div class="text-block">
      <div class="english">See cool,</div>
      <div class="spanish">Ver cool,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="154">
  <div class="line-content">
    <div class="text-block">
      <div class="english">smoke to be cool,</div>
      <div class="spanish">fumar para ser cool,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="156">
  <div class="line-content">
    <div class="text-block">
      <div class="english">feel good. Repeat.</div>
      <div class="spanish">sentirse bien. Repetir.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="157">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Trigger, behavior, reward.</div>
      <div class="spanish">Desencadenante, conducta, recompensa.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="160">
  <div class="line-content">
    <div class="text-block">
      <div class="english">And each time we do this,</div>
      <div class="spanish">Y cada vez que hacemos esto,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="161">
  <div class="line-content">
    <div class="text-block">
      <div class="english">we learn to repeat the process</div>
      <div class="spanish">aprendemos a repetir el proceso</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="163">
  <div class="line-content">
    <div class="text-block">
      <div class="english">and it becomes a habit.</div>
      <div class="spanish">y se convierte en un hábito.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="165">
  <div class="line-content">
    <div class="text-block">
      <div class="english">So later,</div>
      <div class="spanish">Así que más tarde,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="167">
  <div class="line-content">
    <div class="text-block">
      <div class="english">feeling stressed out triggers that urge to smoke a cigarette</div>
      <div class="spanish">sentirse estresado desencadena esa urgencia de fumar un cigarrillo</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="170">
  <div class="line-content">
    <div class="text-block">
      <div class="english">or to eat something sweet.</div>
      <div class="spanish">o de comer algo dulce.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="173">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Now, with these same brain processes,</div>
      <div class="spanish">Ahora, con estos mismos procesos cerebrales,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="176">
  <div class="line-content">
    <div class="text-block">
      <div class="english">we've gone from learning to survive</div>
      <div class="spanish">hemos pasado de aprender a sobrevivir</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="178">
  <div class="line-content">
    <div class="text-block">
      <div class="english">to literally killing ourselves with these habits.</div>
      <div class="spanish">a literalmente matarnos con estos hábitos.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="180">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Obesity and smoking</div>
      <div class="spanish">La obesidad y el tabaquismo</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="182">
  <div class="line-content">
    <div class="text-block">
      <div class="english">are among the leading preventable causes of morbidity and mortality in the world.</div>
      <div class="spanish">están entre las principales causas prevenibles de morbilidad y mortalidad en el mundo.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="187">
  <div class="line-content">
    <div class="text-block">
      <div class="english">So back to my breath.</div>
      <div class="spanish">Volviendo a mi respiración.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="189">
  <div class="line-content">
    <div class="text-block">
      <div class="english">What if instead of fighting our brains,</div>
      <div class="spanish">¿Y si en lugar de luchar contra nuestros cerebros,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="192">
  <div class="line-content">
    <div class="text-block">
      <div class="english">or trying to force ourselves to pay attention,</div>
      <div class="spanish">o tratar de forzarnos a prestar atención,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="194">
  <div class="line-content">
    <div class="text-block">
      <div class="english">we instead tapped into this natural, reward-based learning process ...</div>
      <div class="spanish">aprovecháramos este proceso natural de aprendizaje basado en recompensas...</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="198">
  <div class="line-content">
    <div class="text-block">
      <div class="english">but added a twist?</div>
      <div class="spanish">pero con un giro?</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="200">
  <div class="line-content">
    <div class="text-block">
      <div class="english">What if instead we just got really curious</div>
      <div class="spanish">¿Y si simplemente nos pusiéramos realmente curiosos</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="202">
  <div class="line-content">
    <div class="text-block">
      <div class="english">about what was happening in our momentary experience?</div>
      <div class="spanish">sobre lo que estaba ocurriendo en nuestra experiencia momento a momento?</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="205">
  <div class="line-content">
    <div class="text-block">
      <div class="english">I'll give you an example.</div>
      <div class="spanish">Les daré un ejemplo.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="206">
  <div class="line-content">
    <div class="text-block">
      <div class="english">In my lab,</div>
      <div class="spanish">En mi laboratorio,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="207">
  <div class="line-content">
    <div class="text-block">
      <div class="english">we studied whether mindfulness training could help people quit smoking.</div>
      <div class="spanish">estudiamos si el entrenamiento en mindfulness podía ayudar a las personas a dejar de fumar.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="211">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Now, just like trying to force myself to pay attention to my breath,</div>
      <div class="spanish">Ahora, al igual que tratar de forzarme a prestar atención a mi respiración,</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
<div class="line" data-time="214">
  <div class="line-content">
    <div class="text-block">
      <div class="english">Thank you.</div>
      <div class="spanish">Gracias.</div>
    </div>
    <div class="controls">
      <button class="btn playBtn">Play</button>
      <button class="btn speakBtn">Speak</button>
    </div>
  </div>
</div>
       <!-- (FIN) -->


    </div> <!-- /.dialogue-container -->
  </div> <!-- /.page-max-width -->
<script>
let firstSeekHandled = false;
let player;
let currentTimeout = null;
let currentUtterance = null;
let timeChecker = null;
let scrollEnabled = false;     // scroll automático solo desde el reproductor
let playFromButton = false;    // para diferenciar botones de línea del reproductor

// ====== AJUSTES DE CALIBRACIÓN ======
const START_OFFSET = -0.5;//-1;
const END_PADDING = 1;//2.5;

// ====== YouTube API ======
function onYouTubeIframeAPIReady() {
  player = new YT.Player('player', {
    videoId: '-moW9jvvMr4',
    playerVars: { 
      playsinline: 1, 
      rel: 0, 
      modestbranding: 1,
      controls: 1,        // ← importante: fuerza que se vean los controles
      enablejsapi: 1
    },
    events: {
      onStateChange: onPlayerStateChange,
      onReady: onPlayerReady  // ← ahora solo llamamos a una función limpia
    }
  });
}

// ====== AL CARGAR: solo pausamos (nada de play+pause automático) ======
function onPlayerReady(event) {
  player.pauseVideo(); // asegura que esté parado y con controles visibles
}

// Cargar API
const tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
document.getElementsByTagName('script')[0].parentNode.insertBefore(tag, document.getElementsByTagName('script')[0]);

// ====== RESET GENERAL ======
function resetAll(exceptBtn = null) {
  speechSynthesis.cancel();
  currentUtterance = null;
  if (currentTimeout) clearTimeout(currentTimeout);
  currentTimeout = null;
  document.querySelectorAll(".line").forEach(l => {
    if (!exceptBtn || !l.contains(exceptBtn)) l.classList.remove("active");
  });
  document.querySelectorAll(".playBtn, .speakBtn").forEach(b => {
    if (b !== exceptBtn) {
      b.textContent = b.classList.contains("playBtn") ? "Play" : "Speak";
      delete b.dataset.playing;
      delete b.dataset.speaking;
    }
  });
}

// ====== SCROLL AUTOMÁTICO ======
function scrollLineToCenter(element) {
  const rect = element.getBoundingClientRect();
  const elementCenter = rect.top + rect.height / 2;
  const screenCenter = window.innerHeight / 2;
  const offset = elementCenter - screenCenter - 40; // +30px más abajo
  window.scrollBy({ top: offset, behavior: 'smooth' });
}

function updateActiveLine(currentTime) {
  const lines = Array.from(document.querySelectorAll(".line"));
  let active = null;
  for (let i = 0; i < lines.length; i++) {
    const t = parseFloat(lines[i].dataset.time);
    const next = i < lines.length - 1 ? parseFloat(lines[i+1].dataset.time) : 99999;
    if (currentTime >= t && currentTime < next) {
      active = lines[i];
      break;
    }
  }
  lines.forEach(l => l.classList.remove("active"));
  if (active) {
    active.classList.add("active");
    if (scrollEnabled) scrollLineToCenter(active);
  }
}

// ====== SINCRONIZACIÓN AUTOMÁTICA ======
function onPlayerStateChange(event) {
  if (event.data === YT.PlayerState.PLAYING) {
    if (!playFromButton) scrollEnabled = true;
    playFromButton = false;
    if (timeChecker) clearInterval(timeChecker);
    timeChecker = setInterval(() => updateActiveLine(player.getCurrentTime()), 200);
  } else {
    if (timeChecker) clearInterval(timeChecker);
  }
}

// ====== BOTONES PLAY ======
document.addEventListener("click", e => {
  if (e.target.classList.contains("playBtn")) {
    const btn = e.target;
    const line = btn.closest(".line");
    const rawStartTime = parseFloat(line.dataset.time);
    scrollEnabled = false;
    playFromButton = true;

    if (btn.dataset.playing === "true") {
      player.pauseVideo();
      btn.textContent = "Play";
      delete btn.dataset.playing;
      resetAll(btn);
      line.classList.add("active");
      if (currentTimeout) clearTimeout(currentTimeout);
      return;
    }

    resetAll(btn);
    const allLines = Array.from(document.querySelectorAll(".line"));
    const idx = allLines.indexOf(line);
    const startTime = Math.max(0, rawStartTime + START_OFFSET);
    const rawEndTime = idx < allLines.length - 1 ? parseFloat(allLines[idx + 1].dataset.time) : rawStartTime + 25;
    const endTime = rawEndTime + END_PADDING;
    const duration = (endTime - startTime) * 1000;

    player.seekTo(startTime, true);
    player.playVideo();
    btn.textContent = "Pause";
    btn.dataset.playing = "true";
    line.classList.add("active");

    currentTimeout = setTimeout(() => {
      player.pauseVideo();
      btn.textContent = "Replay";
      delete btn.dataset.playing;
      resetAll(btn);
      line.classList.add("active");
    }, duration);
  }
});

// ====== BOTONES SPEAK ======
document.addEventListener("click", e => {
  if (e.target.classList.contains("speakBtn")) {
    const btn = e.target;
    const line = btn.closest(".line");
    const text = line.querySelector(".english").innerText;
    const rawStartTime = parseFloat(line.dataset.time);
    const startTime = Math.max(0, rawStartTime + START_OFFSET);

    if (btn.dataset.speaking === "true") {
      speechSynthesis.cancel();
      currentUtterance = null;
      btn.textContent = "Speak";
      delete btn.dataset.speaking;
      resetAll(btn);
      line.classList.add("active");
      if (currentTimeout) clearTimeout(currentTimeout);
      return;
    }

    resetAll(btn);

    if (!firstSeekHandled) {
      firstSeekHandled = true;
      player.playVideo();
      setTimeout(() => {
        player.pauseVideo();
        player.seekTo(startTime, true);
        player.pauseVideo();
      }, 250);
    } else {
      player.seekTo(startTime, true);
      player.pauseVideo();
    }

    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "en-US";
    utter.rate = 0.75;
    utter.onstart = () => {
      btn.textContent = "Pause";
      btn.dataset.speaking = "true";
      line.classList.add("active");
    };
    utter.onend = () => {
      btn.textContent = "Replay";
      delete btn.dataset.speaking;
      resetAll(btn);
      line.classList.add("active");
      currentUtterance = null;
    };
    utter.onerror = () => {
      btn.textContent = "Speak";
      delete btn.dataset.speaking;
      resetAll(btn);
      line.classList.add("active");
      currentUtterance = null;
    };
    currentUtterance = utter;
    speechSynthesis.speak(utter);
  }
});

// ====== MOSTRAR/OCULTAR TRADUCCIÓN ======
document.addEventListener("click", e => {
  const tb = e.target.closest(".text-block, .line");
  if (tb && !e.target.closest(".controls")) {
    const span = tb.querySelector(".spanish");
    if (span) span.classList.toggle("visible");
  }
});
</script>
</body>
</html>
