<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Synonym Hunter</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body { 
            margin: 0; overflow: hidden; background: #050505; 
            font-family: 'Press Start 2P', monospace; color: white; user-select: none;
        }
        canvas { display: block; }
        #ui { position: absolute; top: 20px; left: 20px; z-index: 10; pointer-events: none; }
        #start-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: rgba(0,0,0,0.85); z-index: 20; text-align: center;
        }
        h1 { color: #00ff00; text-shadow: 4px 4px #003300; font-size: 35px; margin-bottom: 20px; line-height: 1.5; }
        p { line-height: 2; color: #aaa; font-size: 10px; max-width: 600px;}
        .blink { animation: blinker 1s linear infinite; color: #ffff00; margin-top: 30px; font-size: 14px; cursor: pointer;}
        @keyframes blinker { 50% { opacity: 0; } }
    </style>
</head>
<body>

    <div id="ui">SCORE: <span id="score">0</span> | COMBO: <span id="combo">0</span></div>
    
    <div id="start-screen">
        <h1>SYNONYM HUNTER</h1>
        <p>
            1. Dispara a la palabra en INGLÉS.<br>
            2. Se volverá VERDE (Español Random).<br>
            3. ¡Dispara de nuevo rápido para ver SINÓNIMOS!<br>
            (Cada palabra tiene 3 significados)
        </p>
        <div class="blink">CLICK PARA INICIAR</div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
/* --- BASE DE DATOS DE SINÓNIMOS --- */
// Estructura: { en: "INGLÉS", es: ["OPCION 1", "OPCION 2", "OPCION 3"] }
const wordsDB = [
    {en: "ABATE", es: ["AMAINAR", "MITIGAR", "APLACAR"]},
    {en: "ABERRANT", es: ["ANÓMALO", "DESVIADO", "PECULIAR"]},
    {en: "ABJECT", es: ["ABYECTO", "SÓRDIDO", "VIL"]},
    {en: "ACQUIESCE", es: ["CONSENTIR", "ALLANARSE", "ACCEDER"]},
    {en: "ADMONISH", es: ["REPRENDER", "RECENSURAR", "APERCIBIR"]},
    {en: "ADROIT", es: ["HÁBIL", "DIESTRO", "MAÑOSO"]},
    {en: "ADULATE", es: ["HALAGAR", "ALABAR", "ENCOMIASTICO"]},
    {en: "ADVERSE", es: ["CONTRARIO", "HOSTIL", "DESFAVORABLE"]},
    {en: "ALACRITY", es: ["PRESTEZA", "VIVEZA", "DILIGENCIA"]},
    {en: "AMALGAMATE", es: ["FUSIONAR", "MEZCLAR", "COALESCER"]},
    {en: "AMBIGUOUS", es: ["INCIERTO", "EQUÍVOCO", "ANFIBOLÓGICO"]},
    {en: "AMENABLE", es: ["FLEXIBLE", "DÓCIL", "SUMISO"]},
    {en: "ANACHRONISM", es: ["EXTEMPORANEIDAD", "DESFASADO", "INCONGRUENCIA"]},
    {en: "ANOMALY", es: ["IRREGULARIDAD", "RAREZA", "DISCREPANCIA"]},
    {en: "ANTIPATHY", es: ["AVERSION", "ANIMADVERSION", "RECHAZO"]},
    {en: "APATHY", es: ["INDOLENCIA", "DESIDIA", "PASIVIDAD"]},
    {en: "APPELLATION", es: ["DENOMINACION", "EPÍTETO", "DICTADO"]},
    {en: "ARROGATE", es: ["ADJUDICARSE", "APROPIARSE", "USURPAR"]},
    {en: "ARTICULATE", es: ["ELOCUENTE", "EXPONER", "DISERTAR"]},
    {en: "ASSIDUOUS", es: ["DILIGENTE", "APLICADO", "ESFORZADO"]},
    {en: "ASTUTE", es: ["PERSPICAZ", "INGENIOSO", "SAGAZ"]},
    {en: "AUSPICIOUS", es: ["FAVORABLE", "PROMETEDOR", "VENTUROSO"]},
    {en: "AVARICE", es: ["CODICIA", "USURA", "CAJETERÍA"]},
    {en: "AVOW", es: ["AFIRMAR", "CONFESAR", "DECLARAR"]},
    {en: "BEQUEATH", es: ["LEGADO", "HEREDAR", "TESTAR"]},
    {en: "BIFURCATE", es: ["DIVIDIR", "SEPARAR", "RAMIFICARSE"]},
    {en: "BLIGHT", es: ["FLAGELO", "AZOTE", "PLAGA"]},
    {en: "BOMBASTIC", es: ["GRANDILOCUENTE", "RIMBOMBANTE", "HINCHADO"]},
    {en: "CAJOLE", es: ["HALAGAR", "PERSUADIR", "SONSACAR"]},
    {en: "CALLOW", es: ["INEXPERTO", "NOVATO", "BISÓO"]},
    {en: "CANDID", es: ["FRANCO", "SINCERO", "VERAZ"]},
    {en: "CAPITULATE", es: ["RENDIRSE", "CLINARSE", "DESISTIR"]},
    {en: "CAPRICIOUS", es: ["CAPRICHOSO", "VOLUBLE", "VELEIDOSO"]},
    {en: "CAUSTIC", es: ["CORROSIVO", "CÁUSTICO", "MORDÁZ"]},
    {en: "CHOLERIC", es: ["IRASCIBLE", "COLÉRICO", "IRACUNDO"]},
    {en: "CHRONIC", es: ["PERSISTENTE", "CRÓNICO", "INCURABLE"]},
    {en: "CLANDESTINE", es: ["FURTIVO", "SECRETO", "ESCONDIDO"]},
    {en: "CUMBERSOME", es: ["ENGORROSO", "INMANEJABLE", "TEDIOSO"]},
    {en: "DEBAUCHERY", es: ["DISOLUCIÓN", "VÍCIO", "LUJURIA"]},
    {en: "DEFENESTRATE", es: ["EXPULSAR", "DESTITUIR", "ECHAR"]},
    {en: "DEIGN", es: ["DIGNARSE", "CONDENSCENDER", "MERCER"]},
    {en: "DELINEATE", es: ["TRAZAR", "DELIMITAR", "ESBOZAR"]},
    {en: "DENIGRATE", es: ["DIFAMAR", "CALUMNIAR", "VILIPENDIAR"]},
    {en: "DEVOID", es: ["DESPROVISTO", "VACÍO", "CARENTE"]},
    {en: "DILETTANTE", es: ["AFICIONADO", "AMATEUR", "NOVEL"]},
    {en: "DISCERN", es: ["AVISTAR", "COLUMBRAR", "PERCIBIR"]},
    {en: "DISCOMFIT", es: ["DESCONCERTAR", "CONFUNDIR", "TURBAR"]},
    {en: "DISPARATE", es: ["DISCREPANTE", "DISTINTO", "INCONGRUENTE"]},
    {en: "DISSEMINATE", es: ["DIFUNDIR", "PROPAGAR", "DIVULGAR"]},
    {en: "DISSIPATE", es: ["DISPERSAR", "DISIPAR", "ESFUMAR"]},
    {en: "DOCILE", es: ["MANSO", "APLACIBLE", "DÓCIL"]},
    {en: "DUBIOUS", es: ["DUDOSO", "SOSPECHOSO", "AMBIGUO"]},
    {en: "DWELLING", es: ["MORADA", "RESIDENCIA", "DOMICILIO"]},
    {en: "EBULLIENT", es: ["EXUBERANTE", "FERVIENTE", "ANIMADO"]},
    {en: "EFFUSIVE", es: ["EFUSIVO", "ENTUSIASTA", "CALUROSO"]},
    {en: "EGREGIOUS", es: ["ATROZ", "MONSTRUOSO", "FLAGRANTE"]},
    {en: "ELUCIDATE", es: ["ACLARAR", "DILUCIDAR", "EXPLICITAR"]},
    {en: "EMACIATED", es: ["ENFLAQUECIDO", "DEMACRADO", "ESQUELÉTICO"]},
    {en: "ENDOWMENT", es: ["DÁDIVA", "PREBENDA", "PRERROGATIVA"]},
    {en: "ENERVATE", es: ["DEBILITAR", "EXTENUAR", "AGOTAR"]},
    {en: "ENGENDER", es: ["PRODUCIR", "GENERAR", "ORIGINAR"]},
    {en: "EPHEMERAL", es: ["EFÍMERO", "FUGAZ", "PERECEDERO"]},
    {en: "EQUANIMITY", es: ["SERENIDAD", "APLOMO", "CALMA"]},
    {en: "ERUDITE", es: ["DOCTO", "VERSADO", "SABIO"]},
    {en: "ESCHEW", es: ["EVITAR", "REHUIR", "ELUDIR"]},
    {en: "EUPHEMISM", es: ["SUAVIZAR", "RODEO", "PALIATIVO"]},
    {en: "EXACERBATE", es: ["EMPEORAR", "AGRAVAR", "EXALTAR"]},
    {en: "EXIGENT", es: ["EXIGENTE", "APREMIANTE", "PERENTORIO"]},
    {en: "EXQUISITE", es: ["ESPLÉNDIDO", "MAGNÍFICO", "SUBLIME"]},
    {en: "EXTEMPORANEOUS", es: ["IMPROVISADO", "ESPONTÁNEO", "SIN_PREPARACIÓN"]},
    {en: "FALLACIOUS", es: ["ENGAÑOSO", "FALSO", "FALAZ"]},
    {en: "FASTIDIOUS", es: ["METICULOSO", "ESCOGIDO", "EXQUISITO"]},
    {en: "FATUOUS", es: ["NECIO", "INSENSATO", "VANO"]},
    {en: "FECKLESS", es: ["IRRESPONSABLE", "INÚTIL", "VAGO"]},
    {en: "FEIGN", es: ["SIMULAR", "FINGIR", "APARENTAR"]},
    {en: "FICKLE", es: ["INCONSTANTE", "VOLUBLE", "CAPRICHOSO"]},
    {en: "FILIBUSTER", es: ["OBSTRUCCIONISTA", "BLOQUEAR", "DILATAR"]},
    {en: "FLOUT", es: ["BURLAR", "DESAFIAR", "ESCARNECER"]},
    {en: "FORSWEAR", es: ["RENEGAR", "ABJURAR", "JURAR_FALSO"]},
    {en: "FULSOME", es: ["EXCESIVO", "EMPALAGOSO", "ADULADOR"]},
    {en: "GARISH", es: ["CHILLÓN", "OSTENTOSO", "VISTOSO"]},
    {en: "GARNER", es: ["RECOLECTAR", "ACOPIAR", "ATRAER"]},
    {en: "GRANDILOQUENCE", es: ["RIMBOMBANTE", "ELOCUENCIA", "INFLADO"]},
    {en: "GREGARIOUS", es: ["SOCIABLE", "COMPAÑERO", "EXTROVERTIDO"]},
    {en: "GRIT", es: ["AGALLAS", "TEMPLE", "VALOR"]},
    {en: "HISTRIONIC", es: ["TEATRAL", "DRAMÁTICO", "EXAGERADO"]},
    {en: "IGNOMINIOUS", es: ["VERGONZOSO", "VIL", "HUMILLANTE"]},
    {en: "IMPECABLE", es: ["INMACULADO", "INTACHABLE", "IRREPROCHABLE"]},
    {en: "IMPERTINENT", es: ["IMPROCEDENTE", "INSOLENTE", "IMPERTINENTE"]},
    {en: "IMPLACABLE", es: ["INFLEXIBLE", "INTRATABLE", "CRUEL"]},
    {en: "IMPONDERABLE", es: ["INAPRECIABLE", "INSOSPECHADO", "INESCRUTABLE"]},
    {en: "INANE", es: ["VACUO", "ESTÚPIDO", "INSENSATO"]},
    {en: "INCHOATE", es: ["INCIPENTE", "INACABADO", "RUDIMENTARIO"]},
    {en: "INCORRIGIBLE", es: ["IRREMEDIABLE", "OBSTINADO", "REBELDE"]},
    {en: "INCURSION", es: ["INVASIÓN", "IRRUPCIÓN", "ATAQUE"]},
    {en: "INEFFABLE", es: ["INDESCRIPTIBLE", "INEXPRESABLE", "CELESTIAL"]},
    {en: "INEXORABLE", es: ["INEVITABLE", "IMPLACABLE", "NECESARIO"]},
    {en: "INGENIOUS", es: ["HÁBIL", "CREATIVO", "LUCIDO"]},
    {en: "INNUENDO", es: ["INSINUACIÓN", "SOBRENTENDIDO", "ALUSIÓN"]},
    {en: "INSIPID", es: ["SINSABOR", "INSULSO", "ABURRIDO"]},
    {en: "INSURGENT", es: ["SUBLEVADO", "REBELDE", "SEDICIOSO"]},
    {en: "INTERNECINE", es: ["DESTRUCTOR", "MORTAL", "ASOLADOR"]},
    {en: "INTREPID", es: ["AUDAZ", "OSADO", "VALIENTE"]},
    {en: "INVEIGH", es: ["ARREMETE", "CRITICAR", "ATACAR"]},
    {en: "INVETERATE", es: ["ARRAIGADO", "HABITUAL", "ENRAIZADO"]},
    {en: "JETTISON", es: ["DESECHAR", "ABANDONAR", "DESCARTAR"]},
    {en: "JUDICIOUS", es: ["JUICIOSO", "PRUDENTE", "SENSIBLE"]},
    {en: "LACONIC", es: ["CONCISO", "SUCINTO", "BREVE"]},
    {en: "LASSITUDE", es: ["LASITUD", "FATIGA", "DEBILIDAD"]},
    {en: "LAUDATORY", es: ["ELOGIOSO", "ENCOMIASTICO", "APLAUSIVO"]},
    {en: "LEVITY", es: ["LEVEDAD", "INCONSTANCIA", "FRIVOLIDAD"]},
    {en: "LUCID", es: ["DIÁFANO", "NÍTIDO", "ELUCIDAR"]},
    {en: "MALAISE", es: ["MALESTAR", "INDISPOSICIÓN", "DECAIMIENTO"]},
    {en: "MALIGN", es: ["DIFAMAR", "CALUMNIAR", "DETERIORAR"]},
    {en: "MAUDLIN", es: ["SENTIMENTAL", "MELANCOLICO", "LACRIMOSO"]},
    {en: "MENDACIOUS", es: ["MENTIROSO", "FALAZ", "EMBUSTERO"]},
    {en: "MENDICANT", es: ["INDIGENTE", "MENDIGO", "LIMOSNERO"]},
    {en: "MITIGATE", es: ["APLACAR", "ATENUAR", "SUAVIZAR"]},
    {en: "MOROSE", es: ["MALHUMORADO", "HOSCO", "TACITURNO"]},
    {en: "MUNIFICENT", es: ["GENEROSA", "ESPLÉNDIDO", "MAGNÁNIMO"]},
    {en: "NEFARIOUS", es: ["ABOMINABLE", "RUIN", "VIL"]},
    {en: "NOMENCLATURE", es: ["TERMINOLOGÍA", "GLOSARIO", "VOCABULARIO"]},
    {en: "NOXIOUS", es: ["NOCIVO", "PERNICIOSO", "TÓXICO"]},
    {en: "OBFUSCATE", es: ["CONFUNDIR", "OSCURECER", "VELAR"]},
    {en: "OBSEQUIOUS", es: ["SERVICIAL", "SUMISO", "ADULADOR"]},
    {en: "OBSTREPEROUS", es: ["ESTREPITOSO", "RUIDOSO", "TURBULENTO"]},
    {en: "OMINOUS", es: ["PREMONITORIO", "ACIAMO", "FUNESTO"]},
    {en: "OVERT", es: ["MANIFIESTO", "CLARO", "PATENTE"]},
    {en: "PALPABLE", es: ["TANGIBLE", "EVIDENTE", "PERCEPTIBLE"]},
    {en: "PARAGON", es: ["DECHADO", "MODELO", "EJEMPLAR"]},
    {en: "PARSIMONIOUS", es: ["TACANO", "MISERABLE", "AVARO"]},
    {en: "PECUNIARY", es: ["CAUDAL", "NUMERARIO", "DIVISA"]},
    {en: "PERFIDY", es: ["PERFIDIA", "TRAICIÓN", "DESLEALTAD"]},
    {en: "PERFUNCTORY", es: ["SUPERFICIAL", "RUTINARIO", "DESCUIDADO"]},
    {en: "PERNICIOUS", es: ["DAÑINO", "MALIGNO", "PERNICIOSO"]},
    {en: "PERSPICACIOUS", es: ["PERSPICAZ", "AGUDO", "DISCERNIDOR"]},
    {en: "PETULANT", es: ["IRASCIBLE", "MALHUMORADO", "CAPRICHOSO"]},
    {en: "PHILISTINE", es: ["INCULTO", "BORDE", "PALURDO"]},
    {en: "PLIABLE", es: ["DÚCTIL", "MOLDEABLE", "FLEXIBLE"]},
    {en: "POLEMIC", es: ["CONTROVERSIA", "DISPUTA", "DISCREPANCIA"]},
    {en: "PRAGMATIC", es: ["PRÁCTICO", "REALISTA", "FUNCIONAL"]},
    {en: "PREVARICATE", es: ["ENGAÑAR", "EVASIVA", "MENTIR"]},
    {en: "PROCLIVITY", es: ["INCLINACIÓN", "TENDENCIA", "PROPENSIÓN"]},
    {en: "PROLIFERATE", es: ["MULTIPLICARSE", "CRECER", "DISPERSAR"]},
    {en: "PROSAIC", es: ["VULGAR", "TRIVIAL", "COMÚN"]},
    {en: "PULSATE", es: ["LATIR", "VIBRAR", "PALPITAR"]},
    {en: "PUSILLANIMOUS", es: ["COBARDE", "MEDROSO", "APOCADO"]},
    {en: "QUIESCENT", es: ["QUIETO", "DORMIDO", "LATENTE"]},
    {en: "RAREFY", es: ["ENRARECER", "ADELGAZAR", "DISPERSAR"]},
    {en: "RECALCITRANT", es: ["REBELDE", "INDÓCIL", "OBSTINADO"]},
    {en: "RECONDITE", es: ["OCULTO", "ABSTRUSO", "PROFUNDO"]},
    {en: "REFRACTORY", es: ["TERCO", "CONTUMAZ", "INTRATABLE"]},
    {en: "REFUTE", es: ["REFUTAR", "REBATIR", "DESMENTIR"]},
    {en: "REPUDIATE", es: ["RECHAZAR", "ABJURAR", "RENEGAR"]},
    {en: "REPUGNANT", es: ["NAUSEABUNDO", "ASQUEROSO", "ABYECTO"]},
    {en: "RETICENT", es: ["REACIO", "CALLADO", "RESERVADO"]},
    {en: "SANGUINE", es: ["OPTIMISTA", "ENTUSIASTA", "VITAL"]},
    {en: "SCRUPULOUS", es: ["ESCRUPULOSO", "DILIGENTE", "CONCIENZUDO"]},
    {en: "SERENDIPITY", es: ["CASUALIDAD", "FORTUNA", "HALLAZGO_AFORTUNADO"]},
    {en: "SOPORIFIC", es: ["SOMNÍFERO", "ADORMECEDOR", "NARCÓTICO"]},
    {en: "SPURIOUS", es: ["FALSO", "ESPURIO", "FRAUDULENTO"]},
    {en: "SQUANDER", es: ["DERROCHAR", "MALGASTAR", "DESPILFARRAR"]},
    {en: "STATIC", es: ["ESTÁTICO", "INMÓVIL", "FIJO"]},
    {en: "STOLID", es: ["IMPÁVIDO", "IMPONENTE", "APLOMADO"]},
    {en: "STRIDENT", es: ["CHILLÓN", "ESTRIDENTE", "DESAGRADABLE"]},
    {en: "SUBTERFUGE", es: ["ENGAÑO", "EVSASIVA", "TRIQUIÑUELA"]},
    {en: "SUCCINCT", es: ["SUCINTO", "CONCISO", "ABREVIADO"]},
    {en: "SURREPTITIOUS", es: ["FURTIVO", "CLANDESTINO", "ESCONDIDO"]},
    {en: "SWIFT", es: ["PRESTO", "LIGERO", "AFIANADO"]},
    {en: "TACITURN", es: ["TACITURNO", "RESERVADO", "CALLADO"]},
    {en: "TANGENTIAL", es: ["PERIFÉRICO", "IRRELEVANTE", "ACCESORIO"]},
    {en: "TENACIOUS", es: ["TENAZ", "PERSISTENTE", "FIRME"]},
    {en: "TENUOUS", es: ["FRÁGIL", "DELGADO", "INSUBSTANCIAL"]},
    {en: "TIRADE", es: ["INVECTIVA", "FILÍPICA", "PERORATA"]},
    {en: "TRANSIENT", es: ["TRANSITORIO", "EFÍMERO", "PASAJERO"]},
    {en: "TREPIDATION", es: ["TEMOR", "MIEDO", "RECELO"]},
    {en: "TRUNCATE", es: ["TRUNCAR", "CORTAR", "CERCENAR"]},
    {en: "UBIQUITOUS", es: ["OMNIPRESENTE", "COMÚN", "POR_DOQUIER"]},
    {en: "UNCTUOUS", es: ["UNTUOSO", "ADULADOR", "RESBALADIZO"]},
    {en: "UNDULATE", es: ["ONDULAR", "SERPEAR", "FLUCTUAR"]},
    {en: "UNILATERAL", es: ["PARCIAL", "SESGADO", "EXCLUSIVO"]},
    {en: "UPBRAID", es: ["CRITICAR", "REPRENDER", "RECENSURAR"]},
    {en: "USURP", es: ["ARROGAR", "ASUMIR", "DEPOJAR"]},
    {en: "VACILLATE", es: ["OSCILAR", "DUDAR", "TITUBEAR"]},
    {en: "VACUOUS", es: ["VACÍO", "INSUBSTANCIAL", "BOBOS"]},
    {en: "VEHEMENT", es: ["VEHEMENTE", "APASIONADO", "FURIOSO"]},
    {en: "VENERABLE", es: ["RESPECTABLE", "VETUSTO", "HONORABLE"]},
    {en: "VERACIOUS", es: ["VERAZ", "SINCERO", "HONESTO"]},
    {en: "VEX", es: ["ENFADAR", "IRRITAR", "HOSTIGAR"]},
    {en: "VILIFY", es: ["VILIPENDIAR", "DIFAMAR", "CALUMNIAR"]},
    {en: "VITUPERATE", es: ["CENSURAR", "INSULTAR", "VITUPERAR"]},
    {en: "VOLUMINOUS", es: ["ABULTADO", "GRANDE", "EXTENSO"]},
    {en: "WAN", es: ["PÁLIDO", "LÍVIDO", "DEBILITADO"]},
    {en: "WHIMSICAL", es: ["CAPRICHOSO", "FANTÁSTICO", "JUGUETÓN"]},
    {en: "WISTFUL", es: ["MELANCÓLICO", "AÑORANTE", "PENSATIVO"]},
    {en: "ZEALOUS", es: ["VEHEMENTE", "APASIONADO", "ENTUSIASTA"]},
    {en: "ACCOLADE", es: ["PREMIO", "HONOR", "GALARDÓN"]},
    {en: "BALK", es: ["RESISTIRSE", "OBSTACULIZAR", "FRUSTRAR"]},
    {en: "CHICANERY", es: ["ENGAÑO", "ARGUCIAS", "ARTIMAÑA"]},
    {en: "EFFRONTERY", es: ["DESCARO", "INSOLENCIA", "OSADÍA"]},
    {en: "FETTER", es: ["GRILLETE", "CEPO", "ESTORBO"]},
    {en: "GARRULOUS", es: ["LOCUAZ", "HABLADOR", "CHARLATÁN"]},
    {en: "IGNOMINY", es: ["VERGÜENZA", "AFRENTA", "DESHONRA"]},
    {en: "MAELSTROM", es: ["TORBELLINO", "CAOS", "CONFUSIÓN"]},
    {en: "NOVICE", es: ["NOVATO", "APRENDIZ", "NEÓFITO"]},
    {en: "OBFUSCATE", es: ["CONFUNDIR", "OSCURECER", "VELAR"]},
    {en: "PALATIAL", es: ["LUJOSO", "SUNTUOSO", "GRANDIOSO"]},
    {en: "QUERULOUS", es: ["QUEJOSO", "IRASCIBLE", "PLANIÑERO"]},
    {en: "RANCOR", es: ["RENCOR", "ODIO", "ENCONO"]},
    {en: "SATIATE", es: ["SACIAR", "HARTAR", "REPLEGAR"]},
    {en: "TEMERITY", es: ["TEMERIDAD", "OSADÍA", "AUDACIA"]},
    {en: "UPBRAID", es: ["CRITICAR", "REPRENDER", "RECENSURAR"]},
    {en: "VILIFY", es: ["VILIPENDIAR", "DIFAMAR", "CALUMNIAR"]},
    {en: "WAX", es: ["CRECER", "AUMENTAR", "INCREMENTAR"]},
    {en: "YOKE", es: ["UNIR", "ATORNILLAR", "CONJUNTAR"]},
    {en: "ZEPHYR", es: ["BOCANADA", "VIENTO", "BRISA"]},
];

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const comboEl = document.getElementById('combo');
const startScreen = document.getElementById('start-screen');

/* --- AUDIO ENGINE --- */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playSound(type) {
    if (audioCtx.state === 'suspended') audioCtx.resume();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    const now = audioCtx.currentTime;

    if (type === 'shoot') {
        osc.type = 'square';
        osc.frequency.setValueAtTime(400, now);
        osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
        gain.gain.setValueAtTime(0.05, now);
        gain.gain.linearRampToValueAtTime(0, now + 0.1);
        osc.start(now); osc.stop(now + 0.1);
    } 
    else if (type === 'hit_eng') { // Impacto inicial
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(600, now);
        osc.frequency.linearRampToValueAtTime(800, now + 0.1);
        gain.gain.setValueAtTime(0.05, now);
        gain.gain.linearRampToValueAtTime(0, now + 0.15);
        osc.start(now); osc.stop(now + 0.15);
    }
    else if (type === 'hit_syn') { // Impacto sinónimo (Sonido más agudo/premio)
        osc.type = 'sine';
        osc.frequency.setValueAtTime(1200, now);
        osc.frequency.linearRampToValueAtTime(1800, now + 0.1); // "Ding!"
        gain.gain.setValueAtTime(0.05, now);
        gain.gain.linearRampToValueAtTime(0, now + 0.3);
        osc.start(now); osc.stop(now + 0.3);
    }
}

// Música de fondo ambiental
let musicInterval;
function startMusic() {
    let step = 0;
    const melody = [220, 0, 261, 0, 329, 0, 261, 0]; // Arpegio simple
    if(musicInterval) clearInterval(musicInterval);
    musicInterval = setInterval(() => {
        if(melody[step] > 0) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = 'triangle';
            osc.frequency.value = melody[step] * 0.5; // Octava baja
            gain.gain.value = 0.02;
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.2);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.25);
        }
        step = (step + 1) % melody.length;
    }, 200);
}

/* --- GAME LOGIC --- */
let gameRunning = false;
let score = 0;
let combo = 0;
let lastTime = 0;
let spawnTimer = 0;

// Objetos
const player = { x: 0, y: 0, w: 40, h: 40, speed: 8, color: '#4f46e5' };
let bullets = [];
let enemies = [];
let particles = [];
let stars = [];
const keys = {};

// Ajustar tamaño
function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    player.y = canvas.height - 60;
    player.x = canvas.width / 2 - player.w / 2;
}
window.addEventListener('resize', resize);
resize();

// Generar Estrellas
for(let i=0; i<80; i++) {
    stars.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 2,
        speed: Math.random() * 0.2 + 0.1
    });
}

function spawnEnemy() {
    const data = wordsDB[Math.floor(Math.random() * wordsDB.length)];
    
    // Aquí preparamos la lógica de los 3 sinónimos
    // Creamos una lista de índices [0, 1, 2] y la mezclamos para que el primero sea random
    let indices = [0, 1, 2].sort(() => Math.random() - 0.5);
    
    enemies.push({
        x: Math.random() * (canvas.width - 150) + 75,
        y: -40,
        wordData: data,
        text: data.en, // Empieza en Inglés
        indicesOrder: indices, // El orden random en que aparecerán los sinónimos
        synonymStage: -1, // -1 = Inglés, 0 = 1er sinónimo, 1 = 2do, 2 = 3ro
        speed: Math.random() * 0.8 + 0.4,
        color: '#ffffff',
        timer: 0, // Tiempo de lectura
        fading: false
    });
}

function createExplosion(x, y, color, count=10) {
    for(let i=0; i<count; i++) {
        particles.push({
            x: x, y: y,
            vx: (Math.random() - 0.5) * 6,
            vy: (Math.random() - 0.5) * 6,
            life: 1.0,
            color: color
        });
    }
}

function update(dt) {
    if (!gameRunning) return;

    // Movimiento Jugador
    if (keys['ArrowLeft'] && player.x > 0) player.x -= player.speed;
    if (keys['ArrowRight'] && player.x < canvas.width - player.w) player.x += player.speed;

    // Estrellas
    stars.forEach(s => {
        s.y += s.speed;
        if(s.y > canvas.height) s.y = 0;
    });

    // Spawn
    spawnTimer += dt;
    if (spawnTimer > 2500) { spawnEnemy(); spawnTimer = 0; }

    // Balas
    for (let i = bullets.length - 1; i >= 0; i--) {
        bullets[i].y -= 12;
        if (bullets[i].y < 0) bullets.splice(i, 1);
    }

    // Enemigos (Palabras)
    for (let i = enemies.length - 1; i >= 0; i--) {
        let e = enemies[i];

        // Lógica de caída y desvanecimiento
        if (!e.fading) {
            e.y += e.speed;
            
            // Si ya está traducida, cuenta tiempo para desaparecer
            if (e.synonymStage >= 0) {
                e.timer += dt;
                // Si pasa mucho tiempo sin recibir otro disparo, se desvanece
                if (e.timer > 2500) { 
                    e.fading = true; 
                }
            }
        } else {
            // Efecto desvanecer
            createExplosion(e.x, e.y, e.color, 1); // rastro de partículas
            enemies.splice(i, 1);
            continue;
        }

        // Colisión Bala vs Palabra
        for (let j = bullets.length - 1; j >= 0; j--) {
            let b = bullets[j];
            // Hitbox simple
            if (b.x > e.x - 40 && b.x < e.x + 40 && b.y > e.y - 20 && b.y < e.y + 10) {
                
                bullets.splice(j, 1); // Borrar bala

                // LOGICA DE EVOLUCIÓN DE PALABRA
                if (e.synonymStage < 2) {
                    // Avanzamos al siguiente sinónimo
                    e.synonymStage++;
                    
                    // Obtenemos el índice del array mezclado
                    let nextIndex = e.indicesOrder[e.synonymStage];
                    e.text = e.wordData.es[nextIndex]; // Cambiar texto
                    
                    e.color = '#00ff00'; // Color Verde
                    e.timer = 0; // REINICIAR TEMPORIZADOR (Para dar tiempo a leer o disparar de nuevo)
                    e.y -= 5; // Pequeño empujón hacia arriba (feedback visual)

                    if (e.synonymStage === 0) {
                        playSound('hit_eng'); // Primer golpe
                        score += 10;
                    } else {
                        playSound('hit_syn'); // Golpes de combo (sinónimos)
                        createExplosion(e.x, e.y, '#ffff00', 20); // Explosión amarilla
                        score += 50;
                        combo++;
                    }
                } else {
                    // Ya mostró los 3 sinónimos, explotar final
                    createExplosion(e.x, e.y, '#00ff00', 30);
                    playSound('hit_syn');
                    enemies.splice(i, 1);
                    score += 100;
                }
                
                scoreEl.innerText = score;
                comboEl.innerText = combo;
                break; // Romper bucle de balas para este enemigo
            }
        }

        // Game Over (si toca fondo sin traducir)
        if (e.y > canvas.height) {
            if(e.synonymStage === -1) combo = 0; // Rompe combo si se escapa en inglés
            comboEl.innerText = combo;
            enemies.splice(i, 1);
        }
    }

    // Partículas
    for (let i = particles.length - 1; i >= 0; i--) {
        let p = particles[i];
        p.x += p.vx; p.y += p.vy;
        p.life -= 0.04;
        if(p.life <= 0) particles.splice(i, 1);
    }
}

function draw() {
    // Fondo con rastro suave
    ctx.fillStyle = 'rgba(5, 5, 5, 0.3)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Estrellas
    ctx.fillStyle = '#fff';
    stars.forEach(s => {
        ctx.beginPath(); ctx.arc(s.x, s.y, s.size, 0, Math.PI*2); ctx.fill();
    });

    if(!gameRunning) return requestAnimationFrame(draw);

    // Jugador
    ctx.fillStyle = player.color;
    ctx.beginPath();
    ctx.moveTo(player.x + player.w/2, player.y);
    ctx.lineTo(player.x + player.w, player.y + player.h);
    ctx.lineTo(player.x, player.y + player.h);
    ctx.fill();

    // Balas
    ctx.fillStyle = '#ff0055';
    ctx.shadowBlur = 10; ctx.shadowColor = '#ff0055';
    bullets.forEach(b => ctx.fillRect(b.x - 2, b.y, 4, 15));
    ctx.shadowBlur = 0;

    // Enemigos
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    enemies.forEach(e => {
        ctx.font = e.synonymStage >= 0 ? '20px "Press Start 2P"' : '16px "Press Start 2P"';
        ctx.fillStyle = e.color;
        
        // Si es sinónimo extra (stage 1 o 2), brilla más
        if (e.synonymStage > 0) {
            ctx.shadowBlur = 15; ctx.shadowColor = '#ffff00';
        }
        ctx.fillText(e.text, e.x, e.y);
        ctx.shadowBlur = 0;
        
        // Indicador de "Vida" (Puntos debajo para saber cuántos sinónimos faltan)
        // Dibujamos 3 puntitos
        if (e.synonymStage < 2) {
            for(let k=0; k<3; k++) {
                ctx.fillStyle = k <= e.synonymStage ? '#00ff00' : '#444'; 
                ctx.beginPath();
                ctx.arc(e.x - 15 + (k*15), e.y + 20, 3, 0, Math.PI*2);
                ctx.fill();
            }
        }
    });

    // Partículas
    particles.forEach(p => {
        ctx.fillStyle = p.color;
        ctx.globalAlpha = p.life;
        ctx.fillRect(p.x, p.y, 3, 3);
        ctx.globalAlpha = 1;
    });

    requestAnimationFrame(() => {
        const now = performance.now();
        update(now - lastTime);
        lastTime = now;
        draw();
    });
}

// Input
window.addEventListener('keydown', e => {
    keys[e.code] = true;
    if (e.code === 'Space' && gameRunning) {
        bullets.push({ x: player.x + player.w/2, y: player.y });
        playSound('shoot');
    }
});
window.addEventListener('keyup', e => keys[e.code] = false);

// Start
document.body.addEventListener('click', () => {
    if (!gameRunning) {
        startScreen.style.display = 'none';
        gameRunning = true;
        score = 0; combo = 0;
        enemies.length = 0; bullets.length = 0; particles.length = 0;
        scoreEl.innerText = '0';
        lastTime = performance.now();
        if (audioCtx.state === 'suspended') audioCtx.resume();
        startMusic();
        draw();
    }
});

</script>
</body>
</html>
