<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Generator & Manager</title>
    <style>
        * { box-sizing: border-box; }
        :root {
            --bg: #121212;
            --surface: #1e1e1e;
            --primary: #bb86fc;
            --text: #e0e0e0;
            --border: #333;
            --accent-active: #2196F3;
        }
        body {
            font-family: 'Segoe UI', monospace, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            width: 100%;
        }
        #generator-container {
            width: 100%;
            max-width: none;
            background: var(--surface);
            padding: 20px;
            margin: 0;
            border-bottom: 1px solid var(--border);
            border-radius: 0;
            transition: all 0.3s ease;
        }
        .hidden { display: none !important; }
        h2 { margin-top: 0; color: var(--primary); text-align: center; }
        .switch-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            gap: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #444;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent-active); }
        input:checked + .slider:before { transform: translateX(26px); }
        .mode-label { opacity: 0.5; transition: 0.3s; color: #aaa; }
        .mode-label.active { opacity: 1; color: white; font-weight: bold; }

        .grid-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        .full-width { grid-column: span 2; }
        label { display: block; margin-bottom: 5px; font-size: 0.9em; color: #aaa; }
        input, select, textarea { width: 100%; background: #2d2d2d; border: 1px solid var(--border); color: white; padding: 10px; border-radius: 4px; outline: none; }

        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        button { flex: 1; padding: 12px; cursor: pointer; font-weight: bold; border: none; border-radius: 4px; transition: background 0.2s; }
        #btn-generate { background-color: var(--primary); color: #000; }
        #btn-generate:hover { background-color: #a370db; }
        #btn-paste { background-color: #03dac6; color: #000; }
        #btn-paste:hover { background-color: #01b4a4; }
        #btn-show-gen { background-color: #333; color: #fff; margin: 0; padding: 15px; display: none; width: 100%; border-radius: 0; }

        #prompt-output {
            margin-top: 20px;
            background: #000;
            padding: 15px;
            border: 1px solid var(--primary);
            font-family: monospace;
            white-space: pre-wrap;
            display: none;
        }

        #results-container { width: 100%; max-width: none; padding: 20px; }
        .accordion-item { background: var(--surface); border: 1px solid var(--border); margin-bottom: 10px; border-radius: 4px; overflow: hidden; }
        .accordion-header { padding: 15px; background: #252525; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .accordion-header:hover { background: #303030; }
        .accordion-content { padding: 15px; display: none; border-top: 1px solid var(--border); font-size: 0.95em; line-height: 1.5; }
        .accordion-content.active { display: block; }
        .meta-tag { background: #333; padding: 2px 6px; border-radius: 4px; font-size: 0.8em; margin-right: 5px; }
        .copy-prompt-btn { background: var(--primary); color: black; border: none; padding: 5px 10px; font-size: 0.8em; border-radius: 4px; cursor: pointer; margin-bottom: 10px; display: inline-block; width: auto; flex: none; }
    </style>
</head>
<body>

    <button id="btn-show-gen" onclick="toggleGenerator(true)">âž• New Generation</button>

    <div id="generator-container">
        <h2>Nexus Prompt Engineer</h2>
        
        <div class="switch-wrapper">
            <span id="labelSimple" class="mode-label active">SIMPLE</span>
            <label class="switch">
                <input type="checkbox" id="modeSwitch" onchange="toggleAlgorithmMode()">
                <span class="slider"></span>
            </label>
            <span id="labelComplex" class="mode-label">COMPLEX</span>
        </div>
        <div class="grid-container">
            <div>
                <label>Context</label>
                <input type="text" id="contextInput" list="context-history" placeholder="Ex: React, Finance...">
                <datalist id="context-history"></datalist>
            </div>
            <div>
                <label>Specific Topic</label>
                <input type="text" id="topicInput" list="topic-history" placeholder="Ex: Hooks, ROI...">
                <datalist id="topic-history"></datalist>
            </div>
            <div><label>Mode</label><select id="modeSelect"></select></div>
            <div><label>Format</label><select id="formatSelect"></select></div>
            <div><label>Task Type</label><select id="taskSelect"></select></div>
            <div><label>Voice/Tone</label><select id="voiceSelect"></select></div>
            <div><label>Length</label><select id="lengthSelect"></select></div>
            <div><label>Depth Level</label><select id="levelSelect"></select></div>
        </div>

        <div class="btn-group">
            <button id="btn-generate" onclick="generatePrompt()">âš¡ Generate Prompt</button>
            <button id="btn-paste" onclick="handlePasteResponse()">ðŸ“‹ Paste Response & Hide</button>
        </div>

        <div id="prompt-output"></div>
    </div>

    <div id="results-container"></div>

<script>
/* =========================================
   CONFIG DATA
========================================= */
const COMMON_DATA = {
    MODES: [
        { id: 'tech', label: 'TECHNICAL', role: 'Act as a Senior Engineer.', style: 'Cyberpunk/Terminal style.', goal: 'Technical accuracy and implementation detail.' },
        { id: 'art', label: 'ART', role: 'Act as a Creative Director.', style: 'Minimalist Gallery / Editorial style.', goal: 'Aesthetic refinement and originality.' },
        { id: 'school', label: 'SCHOOL', role: 'Act as a Professor.', style: 'Clean Textbook / Academic style.', goal: 'Structured education and conceptual clarity.' },
        { id: 'story', label: 'STORYTELLING', role: 'Act as a Master Novelist.', style: 'Cinematic, immersive narrative tone.', goal: 'Engaging storytelling and world-building.' },
        { id: 'marketing', label: 'MARKETING', role: 'Act as a Senior Copywriter.', style: 'Persuasive, high-conversion writing.', goal: 'Brand voice alignment & audience engagement.' },
        { id: 'business', label: 'BUSINESS', role: 'Act as a Strategy Consultant.', style: 'Executive brief style.', goal: 'Clarity, precision, and actionable insights.' },
        { id: 'research', label: 'RESEARCH', role: 'Act as a Research Scientist.', style: 'Peer-reviewed academic tone.', goal: 'Evidence-based rigor with citations when relevant.' },
        { id: 'casual', label: 'CASUAL', role: 'Act as a friendly assistant.', style: 'Conversational, natural tone.', goal: 'Clarity, simplicity, and a human-sounding delivery.' }
    ],
    FORMATS: [
        { id: 'html', label: 'HTML APP', instruction: 'Return a single HTML5 file with inline CSS/JS. No external files. Use overflow-y:auto.' },
        { id: 'text', label: 'TEXT GUIDE', instruction: 'Return Markdown text with clear headings and structure.' },
        { id: 'code', label: 'CODE SNIPPET', instruction: 'Return raw code only with comments.' },
        { id: 'essay', label: 'ESSAY', instruction: 'Return a polished formal essay.' },
        { id: 'dialogue', label: 'DIALOGUE', instruction: 'Return a scripted scene or conversation.' },
        { id: 'template', label: 'TEMPLATE', instruction: 'Return a reusable structured template with fillable fields.' },
        { id: 'checklist', label: 'CHECKLIST', instruction: 'Return a concise actionable checklist or SOP.' }
    ]
};

const ALGORITHMS = {
    SIMPLEX: {
        TASK_TYPES: [
            { id: 'explain', label: 'EXPLANATION', instruction: 'Explain the topic clearly and step-by-step.' },
            { id: 'analysis', label: 'ANALYSIS', instruction: 'Break the topic down into components with pros, cons, variables.' },
            { id: 'create', label: 'CREATIVE GENERATION', instruction: 'Generate original content in the selected style.' },
            { id: 'teach', label: 'TEACHING', instruction: 'Introduce, teach, give examples, and add a practice checkpoint.' },
            { id: 'improve', label: 'IMPROVEMENT', instruction: 'Rewrite and enhance the userâ€™s content with better clarity and style.' },
            { id: 'compare', label: 'COMPARISON', instruction: 'Compare items using structure, criteria, and reasoning.' },
            { id: 'build', label: 'CONSTRUCTION', instruction: 'Produce a structured artifact: plan, blueprint, script, architecture, or framework.' }
        ],
        VOICES: [
            { id: 'neutral', label: 'Neutral', instruction: 'Use a balanced, neutral tone.' },
            { id: 'friendly', label: 'Friendly', instruction: 'Use a warm, approachable tone.' },
            { id: 'authoritative', label: 'Authoritative', instruction: 'Use a confident, expert tone.' },
            { id: 'poetic', label: 'Poetic', instruction: 'Use metaphors, rhythm, and evocative language.' },
            { id: 'concise', label: 'Concise', instruction: 'Use highly efficient, compact phrasing.' }
        ],
        LENGTH: [
            { id: 'short', label: 'SHORT', instruction: 'Maximum 2 short paragraphs.' },
            { id: 'medium', label: 'MEDIUM', instruction: 'Up to 6 paragraphs with examples.' },
            { id: 'long', label: 'LONG', instruction: 'Extensive, detailed long-form content.' }
        ],
        FADER_LEVELS: [
            { level: 1, desc: "Basic Summary or Definition" },
            { level: 2, desc: "Add Context, History, or Motivation" },
            { level: 3, desc: "Add Structure, Examples, or Interactions" },
            { level: 4, desc: "Add Advanced Analysis, Troubleshooting, or Exercises" },
            { level: 5, desc: "Full Interactive App / Deep-Dive Artifact" }
        ],
        RESTRICTIONS: [
            "Do not include filler text.",
            "Do not split the output into multiple messages.",
            "No disclaimers unless strictly necessary.",
            "Avoid repetition.",
            "Respect the selected format exactly."
        ]
    },
    COMPLEX: {
        TASK_TYPES: [
            { id: 'explain', label: 'DEMYSTIFY', instruction: 'Take the specific topic and break it down from first principles.' },
            { id: 'analysis', label: 'DECONSTRUCT', instruction: 'Perform a deep-dive analysis. Identify root causes, systemic connections, variables, and potential edge cases.' },
            { id: 'create', label: 'IDEATE & SYNTHESIZE', instruction: 'Generate novel, non-obvious content. Combine disparate concepts to create something original.' },
            { id: 'teach', label: 'SCAFFOLDED MASTERY', instruction: 'Design a learning path. Introduce the concept, show example, explain nuance, provide test.' },
            { id: 'improve', label: 'REFACTOR & ELEVATE', instruction: 'Critique the input. Optimize clarity, efficiency, and impact.' },
            { id: 'compare', label: 'JUXTAPOSE & EVALUATE', instruction: 'Compare entities using rigorous criteria. Highlight trade-offs, synergies, and suitability.' },
            { id: 'build', label: 'ARCHITECT', instruction: 'Construct a complete artifact from start to finish.' }
        ],
        VOICES: [
            { id: 'neutral', label: 'Objective / Analytical', instruction: 'Maintain a bias-free, factual, and detached tone.' },
            { id: 'friendly', label: 'Warm / Collaborative', instruction: 'Use inviting, encouraging tone.' },
            { id: 'authoritative', label: 'Commanding / Expert', instruction: 'Use decisive, confident language.' },
            { id: 'poetic', label: 'Lyrical / Evocative', instruction: 'Use metaphor, rhythm, and imagery.' },
            { id: 'concise', label: 'Minimalist / Direct', instruction: 'Maximize information density. Remove all fluff.' }
        ],
        LENGTH: [
            { id: 'short', label: 'ATOMIC', instruction: 'Distilled format. Max ~100 words.' },
            { id: 'medium', label: 'COMPREHENSIVE', instruction: 'Sufficient detail, examples, and nuance. ~400 words.' },
            { id: 'long', label: 'EXHAUSTIVE', instruction: 'Cover history, theory, application, and edge cases.' }
        ],
        FADER_LEVELS: [
            { level: 1, desc: "Surface: Define the core concept simply" },
            { level: 2, desc: "Context: Add historical background or why it matters" },
            { level: 3, desc: "Mechanics: Explain 'How it works' with examples" },
            { level: 4, desc: "Nuance: Optimization, edge cases, trade-offs" },
            { level: 5, desc: "Mastery: Full systemic integration and advanced synthesis" }
        ],
        RESTRICTIONS: [
            "Strictly follow the chosen FORMAT structure.",
            "Do not include conversational filler. Start directly with output.",
            "Tone must align with MODE and VOICE.",
            "Integrate CONTEXT and SPECIFIC TOPIC seamlessly.",
            "Output must be complete; do not cut off."
        ]
    }
};

/* =========================================
   GLOBAL STATE
========================================= */
let lastGeneratedPrompt = ""; 
let currentData = ALGORITHMS.SIMPLEX;

/* =========================================
   INITIALIZATION
========================================= */
document.addEventListener('DOMContentLoaded', () => {
    populateSelect('modeSelect', COMMON_DATA.MODES);
    populateSelect('formatSelect', COMMON_DATA.FORMATS);
    updateDynamicDropdowns();
    loadHistory('contextInput', 'context-history');
    loadHistory('topicInput', 'topic-history');
});

/* =========================================
   SWITCH SIMPLE/COMPLEX
========================================= */
function toggleAlgorithmMode() {
    const isComplex = document.getElementById('modeSwitch').checked;
    currentData = isComplex ? ALGORITHMS.COMPLEX : ALGORITHMS.SIMPLEX;
    document.getElementById('labelSimple').classList.toggle('active', !isComplex);
    document.getElementById('labelComplex').classList.toggle('active', isComplex);
    updateDynamicDropdowns();
}

function updateDynamicDropdowns() {
    populateSelect('taskSelect', currentData.TASK_TYPES);
    populateSelect('voiceSelect', currentData.VOICES);
    populateSelect('lengthSelect', currentData.LENGTH);

    const levelSel = document.getElementById('levelSelect');
    levelSel.innerHTML = '';
    currentData.FADER_LEVELS.forEach(level => {
        let opt = document.createElement('option');
        opt.value = `Level ${level.level}`;
        opt.textContent = `Level ${level.level} - ${level.desc}`;
        levelSel.appendChild(opt);
    });
}

function populateSelect(id, dataArray) {
    const select = document.getElementById(id);
    select.innerHTML = '';
    dataArray.forEach(item => {
        const opt = document.createElement('option');
        opt.value = item.id;
        opt.textContent = item.label;
        select.appendChild(opt);
    });
}

/* =========================================
   HISTORY MANAGEMENT
========================================= */
function loadHistory(inputId, listId) {
    const history = JSON.parse(localStorage.getItem(listId) || '[]');
    const datalist = document.getElementById(listId);
    datalist.innerHTML = '';
    history.forEach(item => {
        const opt = document.createElement('option');
        opt.value = item;
        datalist.appendChild(opt);
    });
}

function saveHistory(inputId, listId) {
    const val = document.getElementById(inputId).value.trim();
    if (!val) return;
    const history = JSON.parse(localStorage.getItem(listId) || '[]');
    if (!history.includes(val)) {
        history.unshift(val);
        localStorage.setItem(listId, JSON.stringify(history.slice(0, 10))); // Keep last 10
        loadHistory(inputId, listId);
    }
}

/* =========================================
   GENERATE PROMPT
========================================= */
function generatePrompt() {
    const context = document.getElementById('contextInput').value.trim();
    const topic = document.getElementById('topicInput').value.trim();
    const modeId = document.getElementById('modeSelect').value;
    const formatId = document.getElementById('formatSelect').value;
    const taskId = document.getElementById('taskSelect').value;
    const voiceId = document.getElementById('voiceSelect').value;
    const lengthId = document.getElementById('lengthSelect').value;
    const level = document.getElementById('levelSelect').value;

    saveHistory('contextInput', 'context-history');
    saveHistory('topicInput', 'topic-history');

    const mode = COMMON_DATA.MODES.find(m => m.id === modeId) || {};
    const format = COMMON_DATA.FORMATS.find(f => f.id === formatId) || {};
    const task = currentData.TASK_TYPES.find(t => t.id === taskId) || {};
    const voice = currentData.VOICES.find(v => v.id === voiceId) || {};
    const length = currentData.LENGTH.find(l => l.id === lengthId) || {};
    const levelObj = currentData.FADER_LEVELS.find(l => `Level ${l.level}` === level) || {};

    let prompt = `
Act as a ${mode.label || 'Expert'}.
Role: ${mode.role || ''}
Style: ${mode.style || ''}
Goal: ${mode.goal || ''}

Task: ${task.label || ''} 
Instruction: ${task.instruction || ''}

Voice/Tone: ${voice.label || ''} - ${voice.instruction || ''}
Length: ${length.label || ''} - ${length.instruction || ''}
Depth Level: ${level || ''} - ${levelObj.desc || ''}

Format: ${format.label || ''} 
${format.instruction || ''}

Context: ${context || 'General'}
Specific Topic: ${topic || 'None'}

Restrictions: ${currentData.RESTRICTIONS.join('; ')}
`.trim();

    lastGeneratedPrompt = prompt;
    displayPrompt(prompt);
}

/* =========================================
   DISPLAY PROMPT
========================================= */
function displayPrompt(prompt) {
    const output = document.getElementById('prompt-output');
    output.textContent = prompt;
    output.style.display = 'block';
}

/* =========================================
   PASTE RESPONSE HANDLER
========================================= */
function handlePasteResponse() {
    const response = lastGeneratedPrompt || '';
    if (!response) return;
    // Custom handling: here just copies to clipboard and hides generator
    navigator.clipboard.writeText(response).then(() => {
        alert("Prompt copied to clipboard!");
        toggleGenerator(false);
    });
}

/* =========================================
   GENERATOR TOGGLE
========================================= */
function toggleGenerator(show = true) {
    const gen = document.getElementById('generator-container');
    const btn = document.getElementById('btn-show-gen');
    gen.style.display = show ? 'block' : 'none';
    btn.style.display = show ? 'none' : 'block';
}

/* =========================================
   ACCORDION RESULTS
========================================= */
document.getElementById('results-container').addEventListener('click', function(e) {
    if (e.target.classList.contains('accordion-header')) {
        const content = e.target.nextElementSibling;
        content.classList.toggle('active');
    } else if (e.target.classList.contains('copy-prompt-btn')) {
        const text = e.target.previousElementSibling.textContent;
        navigator.clipboard.writeText(text).then(() => alert('Copied!'));
    }
});
</script>

</body>
</html>
