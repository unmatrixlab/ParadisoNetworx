<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Generator & Manager</title>
    <style>
        /* FIX: Esto evita que la barra de scroll horizontal aparezca y mueva la app */
        * { box-sizing: border-box; }

        :root {
            --bg: #121212;
            --surface: #1e1e1e;
            --primary: #bb86fc;
            --text: #e0e0e0;
            --border: #333;
            --accent-active: #2196F3; /* Color para modo Complex */
            --danger: #cf6679; /* Color para eliminar */
        }

        body {
            font-family: 'Segoe UI', monospace, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            width: 100%;
        }

        /* Contenedor Principal (El Generador) */
        #generator-container {
            width: 100%;
            max-width: none;
            background: var(--surface);
            padding: 20px;
            margin: 0;
            border-bottom: 1px solid var(--border);
            border-radius: 0;
            transition: all 0.3s ease;
        }

        .hidden { display: none !important; }

        h2 { margin-top: 0; color: var(--primary); text-align: center; }

        /* --- SWITCH STYLES --- */
        .switch-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            gap: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #444;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent-active); }
        input:checked + .slider:before { transform: translateX(26px); }
        .mode-label { opacity: 0.5; transition: 0.3s; color: #aaa; }
        .mode-label.active { opacity: 1; color: white; font-weight: bold; }

        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .full-width { grid-column: span 2; }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #aaa;
        }

        input, select, textarea {
            width: 100%;
            background: #2d2d2d;
            border: 1px solid var(--border);
            color: white;
            padding: 10px;
            border-radius: 4px;
            outline: none;
        }

        /* Botones */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            flex: 1;
            padding: 12px;
            cursor: pointer;
            font-weight: bold;
            border: none;
            border-radius: 4px;
            transition: background 0.2s;
        }

        #btn-generate { background-color: var(--primary); color: #000; }
        #btn-generate:hover { background-color: #a370db; }

        #btn-paste { background-color: #03dac6; color: #000; }
        #btn-paste:hover { background-color: #01b4a4; }

        #btn-show-gen { 
            background-color: #333; 
            color: #fff; 
            margin: 0;
            padding: 15px;
            display: none;
            width: 100%;
            border-radius: 0;
        }

        /* √Årea de Salida del Prompt */
        #prompt-output {
            margin-top: 20px;
            background: #000;
            padding: 15px;
            border: 1px solid var(--primary);
            font-family: monospace;
            white-space: pre-wrap;
            display: none;
        }

        /* Estilos del Acorde√≥n (Resultados) */
        #results-container {
            width: 100%;
            max-width: none;
            padding: 20px;
        }

        .accordion-item {
            background: var(--surface);
            border: 1px solid var(--border);
            margin-bottom: 10px;
            border-radius: 4px;
            overflow: hidden;
            position: relative; /* Para posicionamiento si fuera necesario */
        }

        .accordion-header {
            padding: 15px;
            background: #252525;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .accordion-header:hover { background: #303030; }

        .header-content {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Bot√≥n de Eliminar */
        .btn-delete {
            background: transparent;
            color: #666;
            border: 1px solid #444;
            padding: 5px 10px;
            border-radius: 4px;
            flex: none;
            font-size: 1.2em;
            line-height: 1;
        }
        .btn-delete:hover {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }

        .accordion-content {
            padding: 15px;
            display: none;
            border-top: 1px solid var(--border);
            font-size: 0.95em;
            line-height: 1.5;
        }

        .accordion-content.active { display: block; }

        .meta-tag {
            background: #333;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8em;
            display: inline-block;
            width: fit-content;
        }

        .copy-prompt-btn {
            background: var(--primary);
            color: black;
            border: none;
            padding: 5px 10px;
            font-size: 0.8em;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 10px;
            display: inline-block;
            width: auto; flex: none;
        }

    </style>
</head>
<body>

    <button id="btn-show-gen" onclick="toggleGenerator(true)">‚ûï New Generation</button>

    <div id="generator-container">
        <h2>Nexus Prompt Engineer</h2>
        
        <div class="switch-wrapper">
            <span id="labelSimple" class="mode-label active">SIMPLE</span>
            <label class="switch">
                <input type="checkbox" id="modeSwitch" onchange="toggleAlgorithmMode()">
                <span class="slider"></span>
            </label>
            <span id="labelComplex" class="mode-label">COMPLEX</span>
        </div>
        <div class="grid-container">
            <div>
                <label>Context</label>
                <input type="text" id="contextInput" list="context-history" placeholder="Ex: React, Finance...">
                <datalist id="context-history"></datalist>
            </div>
            <div>
                <label>Specific Topic</label>
                <input type="text" id="topicInput" list="topic-history" placeholder="Ex: Hooks, ROI...">
                <datalist id="topic-history"></datalist>
            </div>

            <div><label>Mode</label><select id="modeSelect"></select></div>
            <div><label>Format</label><select id="formatSelect"></select></div>
            
            <div><label>Task Type</label><select id="taskSelect"></select></div>
            <div><label>Voice/Tone</label><select id="voiceSelect"></select></div>
            <div><label>Length</label><select id="lengthSelect"></select></div>
            <div><label>Depth Level</label><select id="levelSelect"></select></div>
        </div>

        <div class="btn-group">
            <button id="btn-generate" onclick="generatePrompt()">‚ö° Generate Prompt</button>
            <button id="btn-paste" onclick="handlePasteResponse()">üìã Paste Response & Hide</button>
        </div>

        <div id="prompt-output"></div>
    </div>

    <div id="results-container"></div>

<script>
/* =========================================
   1. CONFIG DATA
   ========================================= */
const COMMON_DATA = {
MODES: [
    { id: 'tech', label: '‚öôÔ∏è Technical', role: 'Act as a Senior Engineer.', style: 'Cyberpunk/Terminal style.', goal: 'Technical accuracy and implementation detail.', icon: '‚öôÔ∏è' },
    { id: 'art', label: 'üé® Art', role: 'Act as a Creative Director.', style: 'Minimalist Gallery / Editorial style.', goal: 'Aesthetic refinement and originality.', icon: 'üé®' },
    { id: 'school', label: 'üìö School', role: 'Act as a Professor.', style: 'Clean Textbook / Academic style.', goal: 'Structured education and conceptual clarity.', icon: 'üìö' },
    { id: 'story', label: 'üìñ Storytelling', role: 'Act as a Master Novelist.', style: 'Cinematic, immersive narrative tone.', goal: 'Engaging storytelling and world-building.', icon: 'üìñ' },
    { id: 'marketing', label: 'üì£ Marketing', role: 'Act as a Senior Copywriter.', style: 'Persuasive, high-conversion writing.', goal: 'Brand voice alignment & audience engagement.', icon: 'üì£' },
    { id: 'business', label: 'üíº Business', role: 'Act as a Strategy Consultant.', style: 'Executive brief style.', goal: 'Clarity, precision, and actionable insights.', icon: 'üíº' },
    { id: 'research', label: 'üî¨ Research', role: 'Act as a Research Scientist.', style: 'Peer-reviewed academic tone.', goal: 'Evidence-based rigor with citations when relevant.', icon: 'üî¨' },
    { id: 'casual', label: 'üòä Casual', role: 'Act as a friendly assistant.', style: 'Conversational, natural tone.', goal: 'Clarity, simplicity, and a human-sounding delivery.', icon: 'üòä' },
    { id: 'ai', label: 'ü§ñ Artificial Intelligence', role: 'Act as an AI Research Scientist.', style: 'Futuristic, code-infused style.', goal: 'Innovative AI solutions and ethical considerations.', icon: 'ü§ñ' },
    { id: 'math', label: 'üßÆ Mathematics', role: 'Act as a Mathematician.', style: 'Formal proofs and equations style.', goal: 'Logical precision and theoretical depth.', icon: 'üßÆ' },
    { id: 'physics', label: '‚öõÔ∏è Physics', role: 'Act as a Theoretical Physicist.', style: 'Quantum/Einstein-inspired style.', goal: 'Fundamental laws and conceptual breakthroughs.', icon: '‚öõÔ∏è' },
    { id: 'biology', label: 'üß¨ Biology', role: 'Act as a Biologist.', style: 'Scientific observation and diagrams style.', goal: 'Life processes and evolutionary insights.', icon: 'üß¨' },
    { id: 'chemistry', label: 'üß™ Chemistry', role: 'Act as a Chemist.', style: 'Molecular and reaction-focused style.', goal: 'Synthesis, reactions, and material properties.', icon: 'üß™' },
    { id: 'medicine', label: 'ü©∫ Medicine', role: 'Act as a Medical Doctor.', style: 'Clinical case study style.', goal: 'Diagnosis, treatment, and patient care.', icon: 'ü©∫' },
    { id: 'data', label: 'üìä Data Science', role: 'Act as a Data Scientist.', style: 'Statistical charts and insights style.', goal: 'Data-driven decisions and predictive modeling.', icon: 'üìä' },
    { id: 'programming', label: 'üíª Programming', role: 'Act as a Senior Software Developer.', style: 'Clean code and debugging style.', goal: 'Efficient algorithms and robust implementation.', icon: 'üíª' },
    { id: 'design', label: '‚úèÔ∏è Design', role: 'Act as a UX/UI Designer.', style: 'Visual mood boards and prototypes style.', goal: 'User-centered aesthetics and functionality.', icon: '‚úèÔ∏è' },
    { id: 'music', label: 'üéµ Music', role: 'Act as a Composer/Music Producer.', style: 'Symphonic or electronic score style.', goal: 'Harmonic innovation and emotional resonance.', icon: 'üéµ' },
    { id: 'literature', label: 'üìú Literature', role: 'Act as a Literary Critic.', style: 'Prose analysis and quotes style.', goal: 'Deep textual interpretation and thematic exploration.', icon: 'üìú' },
    { id: 'philosophy', label: 'ü§î Philosophy', role: 'Act as a Philosopher.', style: 'Socratic dialogue style.', goal: 'Ethical reasoning and existential inquiry.', icon: 'ü§î' },
    { id: 'history', label: 'üèõÔ∏è History', role: 'Act as a Historian.', style: 'Chronological narrative with sources style.', goal: 'Contextual understanding and lessons from the past.', icon: 'üèõÔ∏è' },
    { id: 'psychology', label: 'üß† Psychology', role: 'Act as a Clinical Psychologist.', style: 'Therapeutic case study style.', goal: 'Mental health insights and behavioral analysis.', icon: 'üß†' },
    { id: 'economics', label: 'üíπ Economics', role: 'Act as an Economist.', style: 'Graphs and policy analysis style.', goal: 'Market dynamics and resource allocation.', icon: 'üíπ' },
    { id: 'law', label: '‚öñÔ∏è Law', role: 'Act as a Legal Expert.', style: 'Case law and statutes style.', goal: 'Legal reasoning and justice principles.', icon: '‚öñÔ∏è' },
    { id: 'architecture', label: 'üèóÔ∏è Architecture', role: 'Act as an Architect.', style: 'Blueprint and spatial design style.', goal: 'Functional beauty and sustainable structures.', icon: 'üèóÔ∏è' },
    { id: 'film', label: 'üé¨ Film', role: 'Act as a Film Director.', style: 'Script and storyboard style.', goal: 'Visual storytelling and cinematic impact.', icon: 'üé¨' },
    { id: 'photography', label: 'üì∏ Photography', role: 'Act as a Professional Photographer.', style: 'Composition and lighting style.', goal: 'Capturing moments with artistic vision.', icon: 'üì∏' },
    { id: 'painting', label: 'üñåÔ∏è Painting', role: 'Act as a Painter/Artist.', style: 'Brushstroke and palette style.', goal: 'Expressive color and form exploration.', icon: 'üñåÔ∏è' },
    { id: 'dance', label: 'üíÉ Dance', role: 'Act as a Choreographer.', style: 'Movement sequence style.', goal: 'Bodily expression and rhythmic innovation.', icon: 'üíÉ' },
    { id: 'theater', label: 'üé≠ Theater', role: 'Act as a Theater Director.', style: 'Stage directions and drama style.', goal: 'Live performance and emotional depth.', icon: 'üé≠' },
    { id: 'linguistics', label: 'üó£Ô∏è Linguistics', role: 'Act as a Linguist.', style: 'Phonetic and syntactic analysis style.', goal: 'Language structure and communication.', icon: 'üó£Ô∏è' },
    { id: 'sociology', label: 'üë• Sociology', role: 'Act as a Sociologist.', style: 'Social patterns and surveys style.', goal: 'Society dynamics and cultural norms.', icon: 'üë•' },
    { id: 'anthropology', label: 'üåç Anthropology', role: 'Act as an Anthropologist.', style: 'Ethnographic fieldwork style.', goal: 'Human cultures and evolution.', icon: 'üåç' },
    { id: 'political', label: 'üó≥Ô∏è Political Science', role: 'Act as a Political Analyst.', style: 'Policy debate style.', goal: 'Governance, power, and international relations.', icon: 'üó≥Ô∏è' },
    { id: 'environmental', label: 'üåø Environmental Science', role: 'Act as an Ecologist.', style: 'Ecosystem and sustainability style.', goal: 'Environmental protection and climate solutions.', icon: 'üåø' },
    { id: 'astronomy', label: 'üî≠ Astronomy', role: 'Act as an Astronomer.', style: 'Cosmic observation style.', goal: 'Universe exploration and celestial phenomena.', icon: 'üî≠' },
    { id: 'geology', label: 'ü™® Geology', role: 'Act as a Geologist.', style: 'Rock formations and maps style.', goal: 'Earth processes and resources.', icon: 'ü™®' },
    { id: 'finance', label: 'üí∞ Finance', role: 'Act as a Financial Analyst.', style: 'Balance sheets and forecasts style.', goal: 'Investment strategies and risk management.', icon: 'üí∞' },
    { id: 'entrepreneur', label: 'üöÄ Entrepreneurship', role: 'Act as a Startup Founder.', style: 'Pitch deck and growth style.', goal: 'Innovation and business scaling.', icon: 'üöÄ' },
    { id: 'hr', label: 'üë• Human Resources', role: 'Act as a HR Manager.', style: 'Talent development style.', goal: 'Team building and organizational culture.', icon: 'üë•' },
    { id: 'education', label: 'üéì Education', role: 'Act as an Educational Designer.', style: 'Curriculum and pedagogy style.', goal: 'Learning outcomes and student engagement.', icon: 'üéì' },
    { id: 'journalism', label: 'üì∞ Journalism', role: 'Act as a Investigative Journalist.', style: 'News article style.', goal: 'Fact-based reporting and public awareness.', icon: 'üì∞' },
    { id: 'cooking', label: 'üë®‚Äçüç≥ Culinary Arts', role: 'Act as a Chef.', style: 'Recipe and plating style.', goal: 'Flavor innovation and gastronomic experience.', icon: 'üë®‚Äçüç≥' },
    { id: 'sports', label: '‚öΩ Sports', role: 'Act as a Sports Coach.', style: 'Training plan style.', goal: 'Performance optimization and strategy.', icon: '‚öΩ' },
    { id: 'gaming', label: 'üéÆ Game Design', role: 'Act as a Game Designer.', style: 'Mechanics and narrative style.', goal: 'Immersive gameplay and player engagement.', icon: 'üéÆ' },
    { id: 'fashion', label: 'üëó Fashion', role: 'Act as a Fashion Designer.', style: 'Trend and silhouette style.', goal: 'Style innovation and wearable art.', icon: 'üëó' },
    { id: 'psychotherapy', label: 'üõãÔ∏è Psychotherapy', role: 'Act as a Therapist.', style: 'Empathetic session style.', goal: 'Emotional healing and personal growth.', icon: 'üõãÔ∏è' },
    { id: 'ethics', label: '‚öñÔ∏è Ethics', role: 'Act as an Ethicist.', style: 'Moral dilemma analysis style.', goal: 'Ethical frameworks and decision-making.', icon: '‚öñÔ∏è' },
    { id: 'robotics', label: 'ü¶æ Robotics', role: 'Act as a Robotics Engineer.', style: 'Mechanical and AI integration style.', goal: 'Autonomous systems and practical applications.', icon: 'ü¶æ' },
    { id: 'poetry', label: 'üñãÔ∏è Poetry', role: 'Act as a Poet.', style: 'Verse and metaphor style.', goal: 'Lyrical expression and emotional depth.', icon: 'üñãÔ∏è' }
],
  FORMATS: [
    { id: 'html', label: 'üåê HTML App', instruction: 'Return a single HTML5 file with inline CSS/JS. No external files. Use overflow-y:auto for scrolling.' },
    { id: 'text', label: 'üìÑ Text Guide', instruction: 'Return clean Markdown text with clear headings, lists and structure.' },
    { id: 'code', label: 'üíª Code Snippet', instruction: 'Return raw code only with explanatory comments. No extra text.' },
    { id: 'essay', label: '‚úçÔ∏è Essay', instruction: 'Return a polished, formal essay with introduction, body and conclusion.' },
    { id: 'dialogue', label: 'üí¨ Dialogue', instruction: 'Return a scripted scene or conversation with character names and stage directions.' },
    { id: 'template', label: 'üìã Template', instruction: 'Return a reusable structured template with clear placeholders for customization.' },
    { id: 'checklist', label: '‚úÖ Checklist', instruction: 'Return a concise, actionable checklist or standard operating procedure.' },
    { id: 'renaissance', label: 'üñºÔ∏è Renaissance', instruction: 'Respond in the style of Renaissance art: balanced composition, classical ideals, perspective, humanism and rich symbolism.' },
    { id: 'baroque', label: 'üé≠ Baroque', instruction: 'Respond with dramatic intensity, ornate detail, strong contrast, movement and emotional grandeur typical of Baroque art.' },
    { id: 'romanticism', label: 'üåô Romanticism', instruction: 'Respond with emotional depth, exaltation of nature, individualism, sublime beauty and passionate expression.' },
    { id: 'impressionism', label: 'üå∏ Impressionism', instruction: 'Respond with loose brushwork feel, emphasis on light/color, fleeting moments and everyday scenes.' },
    { id: 'expressionism', label: 'üò± Expressionism', instruction: 'Respond with emotional distortion, bold colors, raw feeling and subjective inner experience.' },
    { id: 'cubism', label: 'üî≥ Cubism', instruction: 'Respond fragmenting reality into geometric planes, multiple viewpoints and abstract reconfiguration.' },
    { id: 'surrealism', label: 'üï≥Ô∏è Surrealism', instruction: 'Respond with dream-like scenes, unexpected juxtapositions, unconscious imagery and bizarre logic.' },
    { id: 'dadaism', label: 'üé≤ Dadaism', instruction: 'Respond with absurdity, irony, anti-art provocation, randomness and rejection of logic.' },
    { id: 'popart', label: 'üí• Pop Art', instruction: 'Respond using bold colors, commercial imagery, irony, mass culture references and repetition.' },
    { id: 'minimalism', label: '‚¨ú Minimalism', instruction: 'Respond with extreme simplicity, clean lines, reduction to essentials and neutral tones.' },
    { id: 'abstractexp', label: 'üåÄ Abstract Expressionism', instruction: 'Respond with gestural spontaneity, large scale, emotional intensity and non-representational forms.' },
    { id: 'classicism', label: 'üèõÔ∏è Classicism', instruction: 'Respond with harmony, clarity, restraint, proportion and inspiration from ancient Greece/Rome.' },
    { id: 'gothic', label: '‚õ™ Gothic', instruction: 'Respond with verticality, pointed arches, intricate detail, mysticism and spiritual aspiration.' },
    { id: 'realism', label: 'üëÅÔ∏è Realism', instruction: 'Respond with objective depiction of everyday life, social truth and unidealized subjects.' },
    { id: 'symbolism', label: 'ü¶ã Symbolism', instruction: 'Respond using metaphors, suggestion, mystery and evocation of ideas/feelings through symbols.' },
    { id: 'fauvism', label: 'üé® Fauvism', instruction: 'Respond with wild bold colors, strong painterly qualities and emotional rather than realistic representation.' },
    { id: 'futurism', label: '‚ö° Futurism', instruction: 'Respond celebrating speed, technology, machinery, youth and violence with dynamic fragmentation.' },
    { id: 'constructivism', label: '‚öôÔ∏è Constructivism', instruction: 'Respond with geometric abstraction, industrial materials and functional purpose serving society.' },
    { id: 'bauhaus', label: 'üè≠ Bauhaus', instruction: 'Respond combining crafts and fine arts, functionality, clean modern design and "form follows function".' },
    { id: 'artdeco', label: 'üóº Art Deco', instruction: 'Respond with luxurious glamour, geometric patterns, bold colors and streamlined modern elegance.' },
    { id: 'postmodern', label: 'üÉè Postmodern', instruction: 'Respond with irony, pastiche, eclecticism, playful references and rejection of grand narratives.' },
    { id: 'conceptual', label: 'üí° Conceptual Art', instruction: 'Respond prioritizing idea over aesthetic, using text, documentation and minimal visual elements.' },
    { id: 'streetart', label: 'üé® Street Art', instruction: 'Respond with urban energy, stencils, murals, social commentary and rebellious spirit.' },
    { id: 'cinematic', label: 'üé¨ Cinematic', instruction: 'Respond as a film sequence: describe shots, lighting, camera movement and dramatic pacing.' },
    { id: 'poetic', label: 'üñãÔ∏è Poetic', instruction: 'Respond in free verse or structured poetry form with rich imagery and rhythm.' },
    { id: 'operatic', label: 'üéº Operatic', instruction: 'Respond with grand emotional arias, dramatic recitatives and theatrical intensity.' },
    { id: 'jazz', label: 'üé∑ Jazz', instruction: 'Respond with improvisation, syncopation, swing feel and spontaneous creative variation.' },
    { id: 'flamenco', label: 'üíÉ Flamenco', instruction: 'Respond with passionate duende, rhythmic footwork, intense emotion and raw vocal cries.' },
    { id: 'screenplay', label: 'üìΩÔ∏è Screenplay', instruction: 'Return properly formatted screenplay pages (FADE IN, scene headings, action lines, dialogue).' },
    { id: 'storyboard', label: 'üìã Storyboard', instruction: 'Describe sequential panels with shot composition, camera angles and key dialogue.' },
    { id: 'manifesto', label: 'üì£ Manifesto', instruction: 'Return a bold, provocative artistic manifesto declaring principles and intentions.' },
    { id: 'sonnet', label: 'üìú Sonnet', instruction: 'Return a 14-line sonnet (Shakespearean or Petrarchan) on the topic.' },
    { id: 'haiku', label: 'üå∏ Haiku', instruction: 'Return traditional or modern haiku(s) capturing essence and seasonal reference.' },
    { id: 'react', label: '‚öõÔ∏è React Component', instruction: 'Return a complete, modern React functional component with hooks and inline styles if needed.' },
    { id: 'json', label: 'üóÇÔ∏è JSON Output', instruction: 'Return valid JSON only, structured for the requested data.' },
    { id: 'mermaid', label: 'üßú‚Äç‚ôÄÔ∏è Mermaid Diagram', instruction: 'Return Mermaid.js syntax for flowchart, sequence, class or other diagram.' },
    { id: 'svg', label: 'üé≠ SVG Graphic', instruction: 'Return standalone SVG code that visually represents the concept.' },
    { id: 'ascii', label: '‚å®Ô∏è ASCII Art', instruction: 'Return detailed ASCII art representing the subject.' },
    { id: 'letter', label: '‚úâÔ∏è Letter', instruction: 'Return a formatted personal or formal letter with salutation and signature.' },
    { id: 'recipe', label: 'üç≥ Recipe', instruction: 'Return a complete recipe with ingredients list and step-by-step instructions.' },
    { id: 'timeline', label: '‚è≥ Timeline', instruction: 'Return a chronological timeline of events with dates and descriptions.' },
    { id: 'mindmap', label: 'üó∫Ô∏è Mind Map', instruction: 'Return a text-based hierarchical mind map structure with branches.' }
]
};

const ALGORITHMS = {
    SIMPLEX: {
       TASK_TYPES: [
    { id: 'explain', label: 'üí° Explanation', instruction: 'Explain the topic clearly, step-by-step, with simple language and examples.' },
    { id: 'analysis', label: 'üîç Analysis', instruction: 'Break the topic down into components, exploring pros, cons, variables, causes and implications.' },
    { id: 'create', label: '‚ú® Creative Generation', instruction: 'Generate original content in the selected style, mode or artistic current.' },
    { id: 'teach', label: 'üìñ Teaching', instruction: 'Introduce the topic, teach progressively, provide examples, and include a practice checkpoint or exercise.' },
    { id: 'improve', label: '‚úçÔ∏è Improvement', instruction: 'Rewrite and enhance the user‚Äôs content for greater clarity, impact, flow and style.' },
    { id: 'compare', label: '‚öñÔ∏è Comparison', instruction: 'Compare two or more items using clear criteria, structure and balanced reasoning.' },
    { id: 'build', label: 'üõ†Ô∏è Construction', instruction: 'Produce a complete structured artifact: plan, blueprint, script, architecture, framework or system.' },
    { id: 'brainstorm', label: 'üí≠ Brainstorm', instruction: 'Generate a wide variety of ideas, concepts or possibilities without judgment.' },
    { id: 'critique', label: 'üñãÔ∏è Critique', instruction: 'Provide constructive, detailed feedback highlighting strengths, weaknesses and suggestions.' },
    { id: 'summarize', label: 'üìù Summarize', instruction: 'Condense the content into its key points while preserving essential meaning.' },
    { id: 'debate', label: 'üó£Ô∏è Debate', instruction: 'Present balanced arguments for and against a position, or simulate both sides of a debate.' },
    { id: 'design', label: 'üé® Design', instruction: 'Create a detailed design concept, including visuals, functionality and user experience.' },
    { id: 'solve', label: 'üîë Problem Solving', instruction: 'Identify the problem, explore solutions step-by-step and recommend the best approach.' },
    { id: 'plan', label: 'üó∫Ô∏è Planning', instruction: 'Develop a detailed step-by-step plan with timelines, resources and milestones.' },
    { id: 'narrate', label: 'üìö Narrate', instruction: 'Tell the story or describe events in an engaging, immersive narrative form.' },
    { id: 'translate', label: 'üåê Translate', instruction: 'Translate the content accurately while preserving tone, nuance and cultural context.' },
    { id: 'research', label: 'üî¨ Research', instruction: 'Gather, synthesize and present key findings on the topic with sources when possible.' },
    { id: 'simulate', label: 'üß© Simulation', instruction: 'Simulate a scenario, conversation, process or outcome with realistic details.' },
    { id: 'evaluate', label: 'üìä Evaluation', instruction: 'Assess quality, effectiveness or value using clear criteria and evidence.' },
    { id: 'persuade', label: 'üóØÔ∏è Persuasion', instruction: 'Craft a compelling argument to convince the reader of a specific viewpoint.' },
    { id: 'reflect', label: 'ü™û Reflection', instruction: 'Explore personal or conceptual implications, insights and deeper meaning.' },
    { id: 'experiment', label: 'üß™ Experiment', instruction: 'Propose or describe an experiment, hypothesis, method and expected results.' },
    { id: 'review', label: '‚≠ê Review', instruction: 'Provide a balanced review of a work, product or experience with rating and justification.' },
    { id: 'forecast', label: 'üîÆ Forecast', instruction: 'Predict future trends or outcomes based on data, patterns and reasoning.' },
    { id: 'roleplay', label: 'üé≠ Roleplay', instruction: 'Assume a specific character or expert role and respond in-character.' },
    { id: 'synthesize', label: 'üîó Synthesize', instruction: 'Combine multiple sources or ideas into a coherent new understanding or framework.' },
    { id: 'visualize', label: 'üëÅÔ∏è Visualize', instruction: 'Describe or help visualize concepts, scenes or data in vivid detail.' },
    { id: 'optimize', label: '‚ö° Optimize', instruction: 'Improve efficiency, performance or results through targeted changes.' },
    { id: 'debug', label: 'üêû Debug', instruction: 'Identify errors or issues and provide step-by-step fixes.' },
    { id: 'inspire', label: 'üåü Inspire', instruction: 'Motivate and spark creativity with uplifting ideas, quotes or vision.' }
],
       VOICES: [
    { id: 'neutral', label: '‚öñÔ∏è Neutral', instruction: 'Use a balanced, objective and neutral tone without emotional bias.' },
    { id: 'friendly', label: 'üòä Friendly', instruction: 'Use a warm, approachable, conversational tone as if talking to a good friend.' },
    { id: 'authoritative', label: 'üéì Authoritative', instruction: 'Use a confident, knowledgeable, expert tone with firm and clear statements.' },
    { id: 'poetic', label: 'üñãÔ∏è Poetic', instruction: 'Use rich metaphors, rhythm, imagery and evocative language.' },
    { id: 'concise', label: '‚úÇÔ∏è Concise', instruction: 'Use short, direct, highly efficient phrasing with no unnecessary words.' },
    { id: 'humorous', label: 'üòÇ Humorous', instruction: 'Use witty humor, light sarcasm, jokes and playful language.' },
    { id: 'sarcastic', label: 'üòè Sarcastic', instruction: 'Use dry wit, irony and subtle mockery while keeping it clever.' },
    { id: 'enthusiastic', label: 'üî• Enthusiastic', instruction: 'Use high energy, excitement, exclamation points and passionate expression.' },
    { id: 'empathetic', label: 'ü§ó Empathetic', instruction: 'Use compassionate, understanding tone that acknowledges feelings.' },
    { id: 'dramatic', label: 'üé≠ Dramatic', instruction: 'Use theatrical intensity, vivid descriptions and heightened emotion.' },
    { id: 'mysterious', label: 'üïØÔ∏è Mysterious', instruction: 'Use enigmatic phrasing, hints, suspense and shadowy undertones.' },
    { id: 'formal', label: 'üé© Formal', instruction: 'Use polished, professional language with proper structure and decorum.' },
    { id: 'casual', label: 'üòé Casual', instruction: 'Use relaxed slang, contractions and everyday conversational style.' },
    { id: 'inspirational', label: 'üåü Inspirational', instruction: 'Use uplifting, motivational language that encourages and empowers.' },
    { id: 'cynical', label: 'üòí Cynical', instruction: 'Use skeptical, pessimistic tone with subtle bitterness or doubt.' },
    { id: 'narrative', label: 'üìñ Narrative', instruction: 'Use third-person storytelling voice with descriptive scene-setting.' },
    { id: 'philosophical', label: 'ü§î Philosophical', instruction: 'Use reflective, contemplative tone exploring deeper meaning and questions.' },
    { id: 'playful', label: 'üéà Playful', instruction: 'Use fun, light-hearted, teasing tone with wordplay and whimsy.' },
    { id: 'serious', label: 'üßê Serious', instruction: 'Use grave, earnest tone focused on importance and gravity.' },
    { id: 'romantic', label: '‚ù§Ô∏è Romantic', instruction: 'Use tender, affectionate language full of passion and intimacy.' },
    { id: 'scientific', label: 'üî¨ Scientific', instruction: 'Use precise, technical terminology with objective observation.' },
    { id: 'journalistic', label: 'üì∞ Journalistic', instruction: 'Use clear, factual reporting style with who/what/when/where/why.' },
    { id: 'childlike', label: 'üë∂ Childlike', instruction: 'Use simple words, wonder, curiosity and innocent perspective.' },
    { id: 'epic', label: '‚öîÔ∏è Epic', instruction: 'Use grand, heroic language worthy of legends and myths.' },
    { id: 'minimalist', label: '‚¨ú Minimalist', instruction: 'Use sparse, clean language with deliberate silence between words.' },
    { id: 'confident', label: 'üí™ Confident', instruction: 'Use bold, self-assured tone that conveys certainty and strength.' },
    { id: 'whisper', label: 'ü§´ Whisper', instruction: 'Use soft, intimate, secretive tone as if sharing a confidence.' },
    { id: 'urgent', label: 'üö® Urgent', instruction: 'Use pressing, immediate tone that conveys importance and time sensitivity.' },
    { id: 'nostalgic', label: 'üìª Nostalgic', instruction: 'Use warm, wistful tone evoking memories of the past.' },
    { id: 'rebellious', label: '‚úä Rebellious', instruction: 'Use defiant, anti-establishment tone challenging norms and authority.' }
],
      LENGTH: [
    { id: 'instant', label: '‚ö° 15 seg', instruction: 'M√°x. 50 palabras. Respuesta ultrarr√°pida, como un mensaje instant√°neo.' },
    { id: 'tweet', label: 'üê¶ 30 seg', instruction: 'M√°x. 280 caracteres. Impacto inmediato, estilo tweet perfecto.' },
    { id: 'flash', label: '‚ú® 1 min', instruction: '150-200 palabras. Lectura de 1 minuto, directa y clara.' },
    { id: 'quick', label: 'üìÑ 2 min', instruction: '300-400 palabras. Respuesta corta pero completa (2 min de lectura).' },
    { id: 'bite', label: 'üç™ 3 min', instruction: '500-600 palabras. Tama√±o ideal para un art√≠culo corto o "bite-sized".' },
    { id: 'coffee', label: '‚òï 5 min', instruction: '800-1000 palabras. Lectura t√≠pica de pausa caf√© (est√°ndar blog).' },
    { id: 'focus', label: 'üß† 8 min', instruction: '1200-1600 palabras. Profundidad media con ejemplos y estructura.' },
    { id: 'deep', label: 'üîç 10 min', instruction: '1800-2200 palabras. Inmersi√≥n real de 10 minutos.' },
    { id: 'longread', label: 'üìú 15 min', instruction: '2500-3500 palabras. Lectura profunda y detallada.' },
    { id: 'essay', label: '‚úçÔ∏è 20 min', instruction: '4000-5000 palabras. Ensayo completo o gu√≠a exhaustiva.' },
    { id: 'feature', label: 'üì∞ 30 min', instruction: '6000-8000 palabras. Art√≠culo de fondo o reportaje largo.' },
    { id: 'chapter', label: 'üìñ 45+ min', instruction: '>10.000 palabras. Equivalente a un cap√≠tulo de libro o tratado extenso.' },
    { id: 'bullets', label: 'üîπ Vi√±etas', instruction: 'Respuesta en puntos claros y concisos (longitud flexible seg√∫n tema).' },
    { id: 'outline', label: 'üóÇÔ∏è Esquema', instruction: 'Estructura jer√°rquica detallada con secciones y subsecciones.' },
    { id: 'essential', label: '‚¨ú Lo esencial', instruction: 'Lo m√°s breve posible sin perder nada importante.' }
],
        FADER_LEVELS: [
    { id: 'level1', label: '1Ô∏è‚É£ B√°sico', instruction: '- Level 1: Basic Summary or Definition.' },
    { id: 'level2', label: '2Ô∏è‚É£ Con contexto', instruction: '- Level 2: Add Context, History, or Motivation.' },
    { id: 'level3', label: '3Ô∏è‚É£ Estructurado', instruction: '- Level 3: Add Structure, Examples, or Interactions.' },
    { id: 'level4', label: '4Ô∏è‚É£ Avanzado', instruction: '- Level 4: Add Advanced Analysis, Troubleshooting, or Exercises.' },
    { id: 'level5', label: '5Ô∏è‚É£ Completo', instruction: '- Level 5: Full Interactive App / Deep-Dive Artifact.' },
    { id: 'level0', label: '0Ô∏è‚É£ Ultra-m√≠nimo', instruction: '- Level 0: Only the absolute essential answer (one sentence or less).' },
    { id: 'level25', label: '2.5Ô∏è‚É£ Contexto + Ejemplo', instruction: '- Level 2.5: Add Context + one clear practical example.' },
    { id: 'level35', label: '3.5Ô∏è‚É£ Estructura + An√°lisis', instruction: '- Level 3.5: Structured content + deeper analysis or troubleshooting.' },
    { id: 'level45', label: '4.5Ô∏è‚É£ Avanzado + Interactivo', instruction: '- Level 4.5: Advanced analysis + simple interactive element (quiz, calculator, etc.).' },
    { id: 'adaptive', label: 'üîÄ Adaptativo', instruction: '- Adaptive: Automatically choose the most appropriate depth level based on the query.' },
    { id: 'progressive', label: 'üìà Progresivo', instruction: '- Progressive: Start at Level 1 and offer expandable sections to go deeper.' },
    { id: 'visual', label: 'üé® Visual prioritario', instruction: '- Visual First: Lead with diagram, chart or visual explanation, then add text.' },
    { id: 'story', label: 'üìñ Como historia', instruction: '- Story Mode: Explain the concept through an engaging narrative or analogy.' },
    { id: 'codecentric', label: 'üíª Code-centrado', instruction: '- Code-Centric: Focus on code examples, scaling from simple snippet (Level 1) to full project (Level 5).' },
    { id: 'masterclass', label: 'üéì Masterclass', instruction: '- Masterclass: Complete premium lesson with theory, practice, exercises and final artifact.' }
],
      RESTRICTIONS: [
    "Do not include filler text.",
    "Do not split the output into multiple messages.",
    "No disclaimers unless strictly necessary.",
    "Avoid repetition.",
    "Respect the selected format exactly.",
    "Do not add unnecessary explanations outside the requested content.",
    "Do not use emojis in the final response unless explicitly requested.",
    "Do not apologize or acknowledge mistakes unless asked.",
    "Do not mention guidelines, instructions, or internal rules.",
    "Do not confirm or acknowledge that you are following instructions.",
    "Do not use meta-commentary about your response.",
    "Do not break character or role unless the selected mode requires it.",
    "Do not generate images unless explicitly confirmed by the user.",
    "Do not invent or hallucinate facts, sources, or citations.",
    "Do not exceed the selected length or depth level.",
    "Do not include external links unless directly relevant and requested.",
    "Do not use markdown formatting beyond what the selected format demands.",
    "Do not add headings, titles, or section breaks unless required by format.",
    "Do not end responses with questions unless the task calls for interaction.",
    "Do not provide alternatives or suggestions unless specifically instructed."
]
    },
    COMPLEX: {
       TASK_TYPES: [
    { id: 'explain', label: 'DEMYSTIFY', instruction: 'Take the specific topic and break it down from first principles. Reveal the underlying logic clearly, making the complex intuitive.' },
    { id: 'analysis', label: 'DECONSTRUCT', instruction: 'Perform a deep-dive analysis. Identify root causes, systemic connections, variables, and potential edge cases within the context.' },
    { id: 'create', label: 'IDEATE & SYNTHESIZE', instruction: 'Generate novel, non-obvious content. Combine disparate concepts from the context to create something original and transformative.' },
    { id: 'teach', label: 'SCAFFOLDED MASTERY', instruction: 'Design a learning path. Introduce the concept, show a concrete example, explain the nuance, and provide a test/challenge for the user.' },
    { id: 'improve', label: 'REFACTOR & ELEVATE', instruction: 'Critique the input. Optimize for clarity, efficiency, and impact. Explain specifically what was improved and why.' },
    { id: 'compare', label: 'JUXTAPOSE & EVALUATE', instruction: 'Compare entities using rigorous criteria. Highlight trade-offs, synergies, and contextual suitability. Declare a winner based on the specific context.' },
    { id: 'build', label: 'ARCHITECT', instruction: 'Construct a complete artifact (plan, blueprint, codebase) from start to finish. Ensure all components logically fit together into a working whole.' },
    { id: 'brainstorm', label: 'DIVERGE & EXPLORE', instruction: 'Generate a wide spectrum of ideas, possibilities, and creative directions without judgment or filtering. Push boundaries and explore the unconventional.' },
    { id: 'critique', label: 'DISSECT & REFINE', instruction: 'Provide sharp, constructive criticism. Highlight strengths, expose weaknesses, and offer precise, actionable recommendations for improvement.' },
    { id: 'summarize', label: 'DISTILL & CRYSTALLIZE', instruction: 'Condense complex or lengthy input into its purest essence. Retain all critical meaning while eliminating noise and redundancy.' },
    { id: 'solve', label: 'DIAGNOSE & RESOLVE', instruction: 'Identify the core problem, explore multiple solution paths, evaluate feasibility, and deliver the optimal, step-by-step resolution.' },
    { id: 'plan', label: 'STRATEGIZE & SEQUENCE', instruction: 'Create a detailed, phased plan with milestones, dependencies, resources, and risk mitigation. Ensure realistic and executable steps.' },
    { id: 'narrate', label: 'IMMERSE & UNFOLD', instruction: 'Transform the topic into a compelling narrative. Use vivid storytelling, character, tension, and pacing to make ideas memorable and emotionally resonant.' },
    { id: 'forecast', label: 'EXTRAPOLATE & PREDICT', instruction: 'Analyze current trends, drivers, and constraints to project plausible future scenarios. Provide probabilities and leading indicators.' },
    { id: 'simulate', label: 'MODEL & PLAY OUT', instruction: 'Construct and run a mental or explicit simulation of a process, scenario, or system. Reveal dynamics, outcomes, and emergent behavior.' },
    { id: 'persuade', label: 'ADVOCATE & SWAY', instruction: 'Craft a compelling, evidence-backed argument to convince the audience of a specific position. Use logic, emotion, and credibility strategically.' },
    { id: 'reflect', label: 'INTROSPECT & ILLUMINATE', instruction: 'Explore deeper implications, personal meaning, philosophical layers, or long-term consequences of the topic.' },
    { id: 'research', label: 'INVESTIGATE & SYNTHESIZE', instruction: 'Gather, evaluate, and integrate the most relevant and credible information on the topic into a coherent, well-supported overview.' },
    { id: 'visualize', label: 'RENDER & ILLUSTRATE', instruction: 'Translate abstract or complex ideas into clear visual metaphors, diagrams, or mental images that enhance understanding.' },
    { id: 'roleplay', label: 'EMBODY & ENACT', instruction: 'Assume a specific persona, historical figure, or expert role and respond fully in-character while staying true to their knowledge and perspective.' }
],
      VOICES: [
    { id: 'neutral', label: 'Objective / Analytical', instruction: 'Maintain a bias-free, factual, and observably detached tone.' },
    { id: 'friendly', label: 'Warm / Collaborative', instruction: 'Use an inviting, encouraging, and psychologically safe tone.' },
    { id: 'authoritative', label: 'Commanding / Expert', instruction: 'Use decisive, unwavering language. Project absolute confidence.' },
    { id: 'poetic', label: 'Lyrical / Evocative', instruction: 'Use metaphor, rhythm, and sensory imagery to paint a picture with words.' },
    { id: 'concise', label: 'Minimalist / Direct', instruction: 'Maximize information density. Remove all fluff. Be surgical.' },
    { id: 'humorous', label: 'Witty / Playful', instruction: 'Employ sharp wit, irony, and light-hearted humor while staying on-topic.' },
    { id: 'sarcastic', label: 'Dry / Sardonic', instruction: 'Use subtle irony, understatement, and clever mockery without overt hostility.' },
    { id: 'enthusiastic', label: 'Vibrant / Energetic', instruction: 'Convey genuine excitement and high energy through vivid language and exclamation.' },
    { id: 'empathetic', label: 'Compassionate / Supportive', instruction: 'Show deep understanding of emotions. Validate feelings and offer gentle guidance.' },
    { id: 'dramatic', label: 'Theatrical / Intense', instruction: 'Heighten stakes with powerful language, tension, and vivid dramatic flair.' },
    { id: 'mysterious', label: 'Enigmatic / Suggestive', instruction: 'Hint rather than state directly. Build intrigue through implication and shadow.' },
    { id: 'formal', label: 'Elegant / Professional', instruction: 'Employ polished, sophisticated language with impeccable structure and decorum.' },
    { id: 'casual', label: 'Relaxed / Conversational', instruction: 'Use everyday speech, contractions, and a laid-back, approachable style.' },
    { id: 'inspirational', label: 'Visionary / Uplifting', instruction: 'Ignite motivation and hope through powerful, aspirational, and empowering language.' },
    { id: 'cynical', label: 'Skeptical / World-Weary', instruction: 'Express doubt and subtle disillusionment while remaining intellectually sharp.' },
    { id: 'narrative', label: 'Storytelling / Immersive', instruction: 'Speak as a masterful storyteller, weaving events into a compelling, flowing narrative.' },
    { id: 'philosophical', label: 'Contemplative / Profound', instruction: 'Explore deeper truths and existential questions with reflective, measured insight.' },
    { id: 'rebellious', label: 'Defiant / Provocative', instruction: 'Challenge norms boldly. Use confrontational, anti-establishment language.' },
    { id: 'romantic', label: 'Passionate / Intimate', instruction: 'Express tender emotion, longing, and beauty through sensual and heartfelt words.' },
    { id: 'scientific', label: 'Precise / Empirical', instruction: 'Use rigorous terminology, evidence-based claims, and clinical detachment.' }
],
      LENGTH: [
    { id: 'short', label: 'ATOMIC', instruction: 'Provide the answer in a distilled format. Maximum impact, minimum word count (approx. 100 words).' },
    { id: 'medium', label: 'COMPREHENSIVE', instruction: 'Explore the topic with sufficient detail, examples, and nuance. Standard depth (approx. 400 words).' },
    { id: 'long', label: 'EXHAUSTIVE', instruction: 'Leave no stone unturned. Cover history, theory, application, and edge cases. Extensive length.' },
    { id: 'micro', label: 'SPARK', instruction: 'Ultra-brief insight or key takeaway. One sharp sentence or bullet list (max 50 words).' },
    { id: 'tweet', label: 'PULSE', instruction: 'High-density punch. Fit within tweet limits with maximum clarity and edge (max 280 characters).' },
    { id: 'bite', label: 'SNAPSHOT', instruction: 'Quick, focused read. One core idea with supporting points (approx. 200 words).' },
    { id: 'standard', label: 'BALANCED', instruction: 'Clear and complete coverage with structure and examples. Ideal default depth (approx. 600 words).' },
    { id: 'deep', label: 'IMMERSIVE', instruction: 'Rich exploration with multiple layers, analogies, and real-world applications (approx. 1000 words).' },
    { id: 'essay', label: 'TREATISE', instruction: 'Formal, in-depth essay structure: introduction, development, counterpoints, conclusion (approx. 2000 words).' },
    { id: 'epic', label: 'MAGNUM', instruction: 'Monumental treatment. Comprehensive history, full theoretical framework, exhaustive examples, and future implications.' },
    { id: 'bullet', label: 'CRYSTAL', instruction: 'Deliver content primarily through precise, hierarchical bullet points. Length flexible for completeness.' },
    { id: 'outline', label: 'BLUEPRINT', instruction: 'Provide a detailed hierarchical outline with sections, subsections, and key insights summarized.' },
    { id: 'narrative', label: 'SAGA', instruction: 'Present the content as an extended, engaging narrative journey. Length adapts to storytelling needs.' },
    { id: 'minimal', label: 'ESSENCE', instruction: 'Absolute minimum viable response. Only what is strictly necessary for understanding.' },
    { id: 'visual', label: 'CANVAS', instruction: 'Prioritize diagrams, tables, or structured visuals. Text serves primarily to support the visual elements.' },
    { id: 'chapter', label: 'TOME', instruction: 'Full book-chapter depth. Complete with subsections, references, exercises, and deep conceptual mapping.' },
    { id: 'flash', label: 'BURST', instruction: 'Rapid-fire key points in numbered or bulleted form. Designed for instant absorption (approx. 150 words).' },
    { id: 'focused', label: 'LASER', instruction: 'Targeted depth on one specific aspect. Ignore breadth, maximize precision on the core element (approx. 800 words).' },
    { id: 'progressive', label: 'LAYERED', instruction: 'Start atomic and progressively deepen. Allow user to expand layers as desired.' },
    { id: 'masterclass', label: 'SYMPHONY', instruction: 'Orchestrate a complete learning experience: theory, practice, reflection, and synthesis at epic scale.' }
],
        FADER_LEVELS: [
    { id: 'level1', label: '1Ô∏è‚É£ Surface', instruction: '- Level 1: Surface (Define the core concept simply).' },
    { id: 'level2', label: '2Ô∏è‚É£ Context', instruction: '- Level 2: Context (Add historical background or \'Why it matters\').' },
    { id: 'level3', label: '3Ô∏è‚É£ Mechanics', instruction: '- Level 3: Mechanics (Explain \'How it works\' with examples).' },
    { id: 'level4', label: '4Ô∏è‚É£ Nuance', instruction: '- Level 4: Nuance (Discuss optimization, edge cases, and trade-offs).' },
    { id: 'level5', label: '5Ô∏è‚É£ Mastery', instruction: '- Level 5: Mastery (Full systemic integration and advanced synthesis).' },
    { id: 'level0', label: '0Ô∏è‚É£ Essence', instruction: '- Level 0: Essence (One-sentence definition or key insight only).' },
    { id: 'level15', label: '1.5Ô∏è‚É£ Surface + Insight', instruction: '- Level 1.5: Surface definition plus one powerful clarifying insight.' },
    { id: 'level25', label: '2.5Ô∏è‚É£ Context + Relevance', instruction: '- Level 2.5: Context plus modern relevance or real-world impact.' },
    { id: 'level35', label: '3.5Ô∏è‚É£ Mechanics + Analogy', instruction: '- Level 3.5: Mechanics with examples plus a strong clarifying analogy.' },
    { id: 'level45', label: '4.5Ô∏è‚É£ Nuance + Application', instruction: '- Level 4.5: Nuance with practical optimization tips and real scenarios.' },
    { id: 'adaptive', label: 'üîÄ Adaptive', instruction: '- Adaptive: Automatically select the optimal depth based on query complexity and user intent.' },
    { id: 'progressive', label: 'üìà Progressive', instruction: '- Progressive: Begin at Surface and offer expandable layers to reach deeper levels.' },
    { id: 'visual', label: 'üé® Visual-Led', instruction: '- Visual-Led: Start with diagram or mental model, then layer text from Surface to Nuance.' },
    { id: 'story', label: 'üìñ Story-Driven', instruction: '- Story-Driven: Explain through narrative or historical anecdote, progressing naturally to Mastery.' },
    { id: 'code', label: 'üíª Code-First', instruction: '- Code-First: Lead with working code example, then explain from Mechanics to Nuance.' },
    { id: 'challenge', label: 'üß© Challenge Mode', instruction: '- Challenge Mode: End with exercises or problems that test understanding up to Mastery.' },
    { id: 'comparative', label: '‚öñÔ∏è Comparative', instruction: '- Comparative: Place concept in relation to alternatives at each level from Surface to Nuance.' },
    { id: 'future', label: 'üîÆ Forward-Looking', instruction: '- Forward-Looking: Extend Mastery level with emerging trends and future implications.' },
    { id: 'minimal', label: '‚¨ú Minimal', instruction: '- Minimal: Deliver only the strictly necessary information at the requested level.' },
    { id: 'synthesis', label: '‚ú® Ultimate Synthesis', instruction: '- Ultimate Synthesis: Full Mastery plus original integrative framework or novel perspective.' }
],
       RESTRICTIONS: [
    "Strictly follow the chosen FORMAT structure.",
    "Do not include conversational filler (e.g., 'Here is your...'). Start directly with the output.",
    "Ensure the tone aligns perfectly with the chosen MODE and VOICE.",
    "Integrate the User's CONTEXT and SPECIFIC TOPIC seamlessly.",
    "Output must be complete; do not cut off or ask to continue.",
    "Do not add meta-commentary about the response or process.",
    "Do not mention selected modes, formats, voices, lengths, or levels.",
    "Do not use emojis unless explicitly permitted by the format.",
    "Do not include disclaimers, warnings, or ethical notes unless strictly required.",
    "Do not repeat information unnecessarily across the response.",
    "Do not invent or hallucinate facts, sources, or references.",
    "Do not exceed the selected LENGTH or FADER_LEVEL depth.",
    "Do not split the response into multiple parts or messages.",
    "Do not end with open questions unless the task explicitly requires interaction.",
    "Do not use markdown beyond what the chosen FORMAT demands.",
    "Do not add headings, titles, or section dividers unless specified by format.",
    "Do not acknowledge user instructions or confirm compliance.",
    "Do not break the chosen VOICE or role under any circumstance.",
    "Do not provide alternatives unless the task specifically calls for them.",
    "Do not include sign-offs, greetings, or closing remarks."
]
    }
};

/* =========================================
   2. GLOBAL STATE
   ========================================= */
let lastGeneratedPrompt = ""; 
let currentData = ALGORITHMS.SIMPLEX; // Por defecto

/* =========================================
   3. INITIALIZATION
   ========================================= */
document.addEventListener('DOMContentLoaded', () => {
    // 1. Cargar datos comunes
    populateSelect('modeSelect', COMMON_DATA.MODES);
    populateSelect('formatSelect', COMMON_DATA.FORMATS);

    // 2. Cargar datos din√°micos
    updateDynamicDropdowns();

    // 3. Cargar historial
    loadHistory('contextInput', 'context-history');
    loadHistory('topicInput', 'topic-history');
});

/* =========================================
   4. LOGICA DE SWITCH
   ========================================= */
function toggleAlgorithmMode() {
    const isComplex = document.getElementById('modeSwitch').checked;
    
    if (isComplex) {
        currentData = ALGORITHMS.COMPLEX;
        document.getElementById('labelSimple').classList.remove('active');
        document.getElementById('labelComplex').classList.add('active');
    } else {
        currentData = ALGORITHMS.SIMPLEX;
        document.getElementById('labelSimple').classList.add('active');
        document.getElementById('labelComplex').classList.remove('active');
    }
    updateDynamicDropdowns();
}

function updateDynamicDropdowns() {
    populateSelect('taskSelect', currentData.TASK_TYPES);
    populateSelect('voiceSelect', currentData.VOICES);
    populateSelect('lengthSelect', currentData.LENGTH);
    
    const levelSel = document.getElementById('levelSelect');
    levelSel.innerHTML = '';
    currentData.FADER_LEVELS.forEach((level) => {
        let opt = document.createElement('option');
        opt.value = level;
        opt.textContent = level.split(':')[0];
        levelSel.appendChild(opt);
    });
}

function populateSelect(id, dataArray) {
    const select = document.getElementById(id);
    select.innerHTML = '';
    dataArray.forEach(item => {
        let opt = document.createElement('option');
        opt.value = item.id;
        opt.textContent = item.label;
        select.appendChild(opt);
    });
}

/* =========================================
   5. MEMORY MANAGEMENT
   ========================================= */
function loadHistory(inputId, listId) {
    const history = JSON.parse(localStorage.getItem(inputId + '_mem')) || [];
    const dataList = document.getElementById(listId);
    if(dataList) {
        dataList.innerHTML = '';
        history.forEach(item => {
            let option = document.createElement('option');
            option.value = item;
            dataList.appendChild(option);
        });
    }
}

function saveToHistory(inputId) {
    const input = document.getElementById(inputId);
    const value = input.value.trim();
    if (!value) return;

    let history = JSON.parse(localStorage.getItem(inputId + '_mem')) || [];
    history = history.filter(item => item !== value);
    history.unshift(value);
    
    if (history.length > 5) history.pop();
    
    localStorage.setItem(inputId + '_mem', JSON.stringify(history));
    loadHistory(inputId, input.getAttribute('list'));
}

/* =========================================
   6. GENERATE PROMPT
   ========================================= */
function generatePrompt() {
    const context = document.getElementById('contextInput').value;
    const topic = document.getElementById('topicInput').value;
    
    const mode = COMMON_DATA.MODES.find(m => m.id === document.getElementById('modeSelect').value);
    const format = COMMON_DATA.FORMATS.find(f => f.id === document.getElementById('formatSelect').value);
    
    const task = currentData.TASK_TYPES.find(t => t.id === document.getElementById('taskSelect').value);
    const voice = currentData.VOICES.find(v => v.id === document.getElementById('voiceSelect').value);
    const len = currentData.LENGTH.find(l => l.id === document.getElementById('lengthSelect').value);
    const level = document.getElementById('levelSelect').value;

    const prompt = `
### ROLE & STYLE
${mode.role} ${mode.style}
Goal: ${mode.goal}

### TASK
Context: ${context}
Topic: ${topic}
Type: ${task.label} - ${task.instruction}

### FORMAT & OUTPUT
Format: ${format.label}
Instruction: ${format.instruction}
Tone: ${voice.instruction}
Length: ${len.instruction}
Depth: ${level}

### RESTRICTIONS
${currentData.RESTRICTIONS.join('\n')}
    `.trim();

    const outputDiv = document.getElementById('prompt-output');
    outputDiv.style.display = 'block';
    outputDiv.textContent = prompt;
    
    navigator.clipboard.writeText(prompt);
    
    lastGeneratedPrompt = prompt;

    saveToHistory('contextInput');
    saveToHistory('topicInput');
}

/* =========================================
   7. PASTE RESPONSE & RESULTS UI
   ========================================= */
async function handlePasteResponse() {
    try {
        const text = await navigator.clipboard.readText();
        if(!text) return alert("Clipboard is empty.");
        createAccordionItem(text);
        toggleGenerator(false);
    } catch (err) {
        alert("Permission denied. Manually paste?");
    }
}

function toggleGenerator(show) {
    const gen = document.getElementById('generator-container');
    const btnShow = document.getElementById('btn-show-gen');
    
    if (show) {
        gen.classList.remove('hidden');
        btnShow.style.display = 'none';
    } else {
        gen.classList.add('hidden');
        btnShow.style.display = 'block';
    }
}

/* --- FUNCI√ìN MODIFICADA PARA INCLUIR BORRAR --- */
function createAccordionItem(contentText) {
    const container = document.getElementById('results-container');
    const id = Date.now();
    
    const mode = document.getElementById('modeSelect').options[document.getElementById('modeSelect').selectedIndex].text;
    const topic = document.getElementById('topicInput').value || "Untitled Result";
    const promptForThisItem = lastGeneratedPrompt;

    const item = document.createElement('div');
    item.className = 'accordion-item';
    
    item.innerHTML = `
        <div class="accordion-header" onclick="toggleAccordion(${id})">
            <div class="header-content">
                <span class="meta-tag">${mode}</span>
                <strong>${topic}</strong>
            </div>
            <div class="header-actions">
                <button class="btn-delete" onclick="deleteItem(event, this)">üóëÔ∏è</button>
                <span>‚ñº</span>
            </div>
        </div>
        <div class="accordion-content" id="content-${id}">
            <button class="copy-prompt-btn" onclick="copyTextToClipboard(this)">
                üìú Copy Original Prompt
            </button>
            <div style="display:none;" class="prompt-source">${promptForThisItem}</div>
            
            <hr style="border:0; border-top:1px solid #444; margin:10px 0;">
            
            <div style="white-space: pre-wrap;">${escapeHtml(contentText)}</div>
        </div>
    `;

    container.insertBefore(item, container.firstChild);
}

/* --- NUEVA FUNCI√ìN PARA BORRAR --- */
function deleteItem(event, btnElement) {
    // Detiene la propagaci√≥n para que no se abra/cierre el acorde√≥n al hacer click en borrar
    event.stopPropagation();
    
    if(confirm("Are you sure you want to delete this result?")) {
        const item = btnElement.closest('.accordion-item');
        item.remove();
    }
}

function toggleAccordion(id) {
    const content = document.getElementById(`content-${id}`);
    const isVisible = content.classList.contains('active');
    
    document.querySelectorAll('.accordion-content').forEach(c => c.classList.remove('active'));

    if (!isVisible) {
        content.classList.add('active');
    }
}

function copyTextToClipboard(btnElement) {
    const promptText = btnElement.nextElementSibling.textContent;
    navigator.clipboard.writeText(promptText).then(() => {
        const originalText = btnElement.innerText;
        btnElement.innerText = "Copied!";
        setTimeout(() => btnElement.innerText = originalText, 1500);
    });
}

function escapeHtml(text) {
    if (!text) return text;
    return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
}
</script>

</body>
</html>
